"use strict";var DD={generatedId:1,genId:function(){return this.generatedId++},extend:function(){for(var a=arguments,b=a[0],c=1;c<a.length;c++)if("object"==typeof a[c]){var d=DD.clone(a[c]);for(var e in d)"object"==typeof d[e]&&"object"==typeof b[e]?b[e]=DD.merge(b[e],d[e]):b[e]=d[e]}return b},merge:function(a,b,c){function d(a,b){if(-1!==e.indexOf(b))return b;if(e.push(b),DD.isArray(a)&&DD.isArray(b))b.forEach(function(b,c){DD.isArray(b)?a[c]=d([],b):DD.isObject(b)?a[c]=d({},b):a[c]=b});else for(var c in b)DD.isObject(b[c])?(DD.isObject(a[c])||(a[c]={}),d(a[c],b[c])):DD.isArray(b[c])?(DD.isArray(a[c])||(a[c]=[]),b[c].forEach(function(b,e){var f;f=DD.isObject(b)?d({},b):DD.isArray(b)?d([],b):b,a[c][e]=f})):void 0!==b[c]&&(a[c]=b[c]);return a}if("object"!=typeof a)throw DD.Error.handle("invoke","DD.merge",0,"object");if("object"!=typeof b)throw DD.Error.handle("invoke","DD.merge",1,"object");var e=[];return d(a,b),a},clone:function(a){var b;return DD.isObject(a)?(b={},DD.getOwnProps(a).forEach(function(c,d){"$"!==c[0]&&(DD.isObject(a[c])||DD.isArray(a[c])?b[c]=DD.clone(a[c]):b[c]=a[c])})):DD.isArray(a)&&(b=[],a.forEach(function(a,c){DD.isObject(a)||DD.isArray(a)?b[c]=DD.clone(a):b[c]=a})),b},assign:function(a,b){return Object.assign?Object.assign(a,b):DD.getOwnProps(b).forEach(function(c){a[c]=b[c]}),a},getOwnProps:function(a){return a?Object.getOwnPropertyNames(a):[]},isFunction:function(a){return void 0!==a&&null!==a&&a.constructor===Function},isArray:function(a){return void 0!==a&&null!==a&&a.constructor===Array},isObject:function(a){return null!==a&&void 0!==a&&a.constructor===Object},isInt:function(a){return Number.isInteger(a)},isNumber:function(a){return"number"==typeof a},isBoolean:function(a){return"boolean"==typeof a},isString:function(a){return"string"==typeof a},isEmpty:function(a){if(null===a||void 0===a)return!0;var b=typeof a;if(DD.isObject(a)){var c=Object.keys(a);if(void 0!==c)return 0===c.length}else if("string"===b)return""===a;return!1},get:function(a,b,c){return c=c||document,b===!0?c.querySelectorAll(a):c.querySelector(a)},append:function(a,b){if(DD.isNode(b))a.appendChild(b);else if(DD.isString(b)){var c=DD.newEl("div");c.innerHTML=b,DD.transChildren(c,a)}},isEl:function(a){return void 0!==a&&null!==a&&a.nodeType===Node.ELEMENT_NODE},isNode:function(a){return void 0!==a&&null!==a&&(a.nodeType===Node.TEXT_NODE||a.nodeType===Node.ELEMENT_NODE||a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)},cloneNode:function(a){if(!DD.isNode(a))throw DD.Error.handle("invoke","DD.cloneNode",0,"Node");var b=a.cloneNode(!0);return DD.copyProp(b,a),b},copyProp:function(a,b){var c={};if(a&&b){var d=["$model","$module","$events"];DD.getOwnProps(b).forEach(function(a){if("$"===a[0]){for(var e=!1,f=0;f<d.length;f++)if(a===d[f]){e=!0;break}e||(c[a]=b[a])}}),DD.merge(a,c),a.$module=b.$module,a.$events={},b.$model&&(a.$model={},DD.getOwnProps(b.$model).forEach(function(c){a.$model[c]=b.$model[c]})),DD.isEmpty(b.$events)||DD.getOwnProps(b.$events).forEach(function(c){var d=b.$events[c];if(d instanceof DD.Event){d.module;d.view=a,delete d.module;var e=DD.merge({},d);new DD.Event(e)}});for(var e=0;e<a.childNodes.length;e++)DD.copyProp(a.childNodes[e],b.childNodes[e])}},getAttrs:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.getAtrs",0,"element");for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.name)&&c.push(e)}return c},getTranslate:function(a){var b,c=a.style.transform;if(c&&"none"!==c){b=[];var d=c.substring(c.indexOf("(")+1,c.indexOf(")")-1);d=d.split(",");for(var e=0;e<d.length;e++)b.push(parseInt(d[e]))}return b?b:[0,0,0]},getAttrsByValue:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.getAttrsByValue",0,"element");if(!b instanceof RegExp)throw DD.Error.handle("invoke","DD.getAttrsByValue",1,"RegExp");for(var c=[],d=0;d<a.attributes.length;d++){var e=a.attributes[d];b.test(e.value)&&c.push(e)}return c},copyAttrs:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.copyAttrs",0,"element");if(!DD.isEl(b))throw DD.Error.handle("invoke","DD.copyAttrs",1,"element");for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b.setAttribute(d.name,d.value)}},newEl:function(a,b,c){if(!DD.isString(a)||DD.isEmpty(a))throw DD.Error.handle("invoke","DD.newEl",0,"string");var d=document.createElement(a);return DD.isObject(b)?DD.attr(d,b):DD.isString(c)&&(d.innerHTML=c),d},newSvgEl:function(a){return document.createElementNS("http://www.w3.org/2000/svg",a)},replaceNode:function(a,b,c){if(!DD.isNode(a))throw DD.Error.handle("invoke","DD.replaceNode",0,"Node");if(!DD.isNode(b)&&!DD.isArray(b))throw DD.Error.handle("invoke1","DD.replaceNode",1,"Node","Node Array");var d=a.parentNode,e=a.nextSibling;null!==d&&(d.removeChild(a),DD.isArray(b)||(b=[b]),b.forEach(function(b){void 0===e||null===e?d.appendChild(b):d.insertBefore(b,e),c!==!1&&(c=!0),c&&a.$isView&&DD.copyProp(b,a)}))},insertAfter:function(a,b,c){var d=this;if(!DD.isNode(a))throw DD.Error.handle("invoke","DD.insertAfter",0,"Node");if(!DD.isNode(b)&&!DD.isNode(c))throw DD.Error.handle("invoke2","DD.insertAfter",1,2,"Node");var e=null;void 0===b||null===b?e=c.firstChild:(c=b.parentNode,e=b.nextSibling),DD.isNode(c)&&(null===e?DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.appendChild(a)}):c.appendChild(a):DD.isArray(a)?a.forEach(function(a){d.isEl(a)&&c.insertBefore(a,e)}):c.insertBefore(a,e))},empty:function(a){var b=this;if(!b.isEl(a))throw DD.Error.handle("invoke","DD.empty",0,"Element");for(var c=a.childNodes,d=c.length-1;d>=0;d--)a.removeChild(c[d])},remove:function(a){var b=this;if(!b.isNode(a))throw DD.Error.handle("invoke","DD.remove",0,"Node");null!==a.parentNode&&a.parentNode.removeChild(a)},copyChildren:function(a){var b=this;if(!b.isEl(a))throw DD.Error.handle("invoke","DD.copyChildren",0,"Element");for(var c=a.childNodes,d=[],e=c.length-1;e>=0;e--)d.push(c[e]);return d},transChildren:function(a,b){var c=this;if(!c.isEl(a))throw DD.Error.handle("invoke","DD.copyChildren",0,"Element");if(!c.isEl(b))throw DD.Error.handle("invoke","DD.copyChildren",1,"Element");for(var d=document.createDocumentFragment();a.childNodes.length>0;)d.appendChild(a.childNodes[0]);b.appendChild(d)},attr:function(a,b,c){var d=this;if(!d.isEl(a))throw DD.Error.handle("invoke","DD.attr",0,"Element");if(DD.isEmpty(b))throw DD.Error.handle("invoke","DD.attr",1,"string","object");if(void 0===c||null===c){if(DD.isObject(b))DD.getOwnProps(b).forEach(function(c){"value"===c?a[c]=b[c]:a.setAttribute(c,b[c])});else if(DD.isString(b))return"value"===b?b.value:a.getAttribute(b)}else"value"===b?a[b]=c:a.setAttribute(b,c)},css:function(a,b,c){var d=this;if(!d.isEl(a))throw DD.Error.handle("invoke","DD.css",0,"Element");if(DD.isEmpty(b))throw DD.Error.handle("invoke1","DD.css",1,"string","object");var e;if(window.getComputedStyle&&(e=window.getComputedStyle(a,null)),e)if(void 0===c||null===c){if(!DD.isObject(b))return e[b];DD.getOwnProps(b).forEach(function(c){void 0!==DD.cssconfig&&void 0!==DD.cssconfig[c]?DD.cssconfig[c].forEach(function(d){a.style[d]=b[c]}):a.style[c]=b[c]})}else void 0!==DD.$cssconfig&&void 0!==DD.$cssconfig[b]?DD.$cssconfig[b].forEach(function(b){a.style[b]=c}):a.style[b]=c},width:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.width",0,"Element");if(!DD.isNumber(b)){var c;if(window.getComputedStyle&&(c=window.getComputedStyle(a,null)),!c)return null;var d=parseInt(c.width);if(b===!0){var e=parseInt(c.paddingLeft)+parseInt(c.paddingRight);d-=e}return d}a.style.width=b+"px"},height:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.height",0,"Element");if(!DD.isNumber(b)){var c;if(window.getComputedStyle&&(c=window.getComputedStyle(a,null)),!c)return null;var d=parseInt(c.height);if(b===!0){var e=parseInt(c.paddingTop)+parseInt(c["paddingBotto,"]);d-=e}return d}a.style.height=b+"px"},addClass:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.addClass",0,"Element");if(DD.isEmpty(b))throw DD.Error.handle("invoke","DD.addClass",1,"string");var c=a.className.trim();if(DD.isEmpty(c))a.className=b;else{for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return;d.push(b),a.className=d.join(" ")}},removeClass:function(a,b){if(!DD.isEl(a))throw DD.Error.handle("invoke","DD.removeClass",0,"Element");if(DD.isEmpty(b))throw DD.Error.handle("invoke","DD.removeClass",1,"string");var c=a.className.trim();if(!DD.isEmpty(c))for(var d=c.split(/\s+/),e=0;e<d.length;e++)if(d[e]===b)return d.splice(e,1),void(a.className=d.join(" "))},formatDate:function(a,b){if(DD.isString(a)){var c=new RegExp(/^\d+$/);if(null!==c.exec(a))try{a=parseInt(a)}catch(d){}}var a=new Date(a);if(isNaN(a.getDay()))return"";var e={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours()%12===0?12:a.getHours()%12,"H+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()},f={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};return/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),DD.getOwnProps(e).forEach(function(a){new RegExp("("+a+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)))}),/(E+)/.test(b)&&(b=b.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+f[a.getDay()+""])),b},toDate:function(a){var b;try{b=new Date(Date.parse(a))}catch(c){}if(!b)throw DD.Error.handle("invoke","DD.toDate",0,"date string");return(isNaN(b)||isNaN(b.getDay()))&&(14===a.length?(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2)+" "+a.substr(8,2)+":"+a.substr(10,2)+":"+a.substr(12),b=new Date(Date.parse(a))):8===a.length&&(a=a.substr(0,4)+"/"+a.substr(4,2)+"/"+a.substr(6,2),b=new Date(Date.parse(a)))),b},compileStr:function(a){for(var b,c=new RegExp(/\{.+?\}/),d=arguments;null!==(b=c.exec(a));){var e,f=b[0].substr(1,b[0].length-2),g=parseInt(f)+1;e=void 0!==d[g]?d[g]:"",a=a.replace(c,e)}return a},parseJson:function(a){a=a.trim();var b=a.substr(1,a.length-2).split(","),c={},d=new RegExp(/\'/g);new RegExp(/\"/g);return b.forEach(function(a){var b=a.split(":");if('"'!==b[0]&&"'"!==b[0]||'"'!==b[b.length-1]&&"'"!==b[b.length-1]){var e=b[0].replace(d,"\\'"),f=b[1],g=f.length;g>2&&('"'===f[0]&&'"'===f[g-1]||'"'===f[0]&&'"'===f[g-1])&&(f=f.substr(1,g-2)),c[e]=f}}),c},load:function(a,b,c,d,e){var f=DD.get("head");switch(null===f&&(f=document.body),a){case"css":var g=DD.get("link[href='"+b+"']");if(null!==g)return;var h=DD.newEl("link");h.type="text/css",h.rel="stylesheet",h.href=b,f.appendChild(h),DD.isFunction(c)&&c();break;case"js":var g=DD.get("script[dsrc='"+b+"']");if(null!==g)return void(DD.isFunction(c)&&c());var i=DD.newEl("script");f.appendChild(i),i.setAttribute("dsrc",b),DD.request({url:b,type:"js",async:!e,successFunc:function(a){var b=DD.newEl("script");d&&(a=d+"="+a),b.innerHTML=a,f.appendChild(b),b.innerHTML="",f.removeChild(b),DD.isFunction(c)&&c()}})}},request:function(a){var b=new XMLHttpRequest;if(DD.isEmpty(a.url))throw DD.Error.handle("invoke","DD.request","config.url","string");if(a.params&&!DD.isObject(a.params))throw DD.Error.handle("invoke","DD.request","config.params","object");a.rand&&(a.params=a.params||{},a.params.$rand=Math.random());var c=a.async===!1?!1:!0;"function"==typeof a.successFunc&&(b.onload=function(c){switch(b.status){case 200:var d=b.responseText;switch(a.type){case"json":try{d=JSON.parse(d)}catch(c){d={success:!1,result:{errmsg:"未知错误"}}}}void 0!==d.success&&d.success===!1&&Dialog.showErrmsg(d.result.errmsg),a.successFunc.call(b,d);break;default:DD.isFunction(a.errorFunc)&&a.errorFunc.call(b,b.status)}}),DD.isFunction(a.errorFunc)&&(b.onerror=a.errorFunc),DD.isFunction(a.timeoutFunc)&&(b.ontimeout=a.timeoutFunc);var d=a.reqType||"GET",e=a.url;switch(a.timeout=a.timeout||6e4,d){case"GET":var f;if(DD.isObject(a.params)){var g=[];DD.getOwnProps(a.params).forEach(function(b){g.push(b+"="+a.params[b])}),f=g.join("&")}void 0!==f&&(e+=-1!==e.indexOf("?")?"&"+f:"?"+f),b.open(d,e,c,a.user,a.pwd),c&&(b.timeout=a.timeout),b.send(null);break;case"POST":var h=new FormData;for(var i in a.params)h.append(i,a.params[i]);b.open(d,e,c,a.user,a.pwd),b.timeout=a.timeout,b.send(h)}}};DD.config={renderTick:50,appPath:"",deviceType:"ontouchend"in document?1:2},function(){var a=function(a){var b=this;if(b.events=[],b.view=a.view,b.handler=a.handler,b.eventName=a.eventName,b.delg=a.delg||!1,b.nopopo=a.nopopo||!1,b.once=a.once||!1,b.capture=a.capture||!1,b.view.$events=b.view.$events||{},1===DD.config.deviceType)switch(b.eventName){case"click":b.eventName="tap";break;case"mousedown":b.eventName="touchstart";break;case"mouseup":b.eventName="touchend";break;case"mousemove":b.eventName="touchmove"}b.delg?b.delegate():b.bind()};a.prototype.fire=function(a){function b(){for(var b=0;b<d.events.length;b++){var c=d.events[b];if(c.view.contains(a.target)){if(c.nopopo&&a.stopPropagation(),c.handler.call(d.view.$module.model,a,c.view.$getData().data,c.view),c.once&&d.events.splice(b--,1),c.nopopo)return!1;break}}return!0}function c(){DD.isFunction(d.handler)&&(d.nopopo&&a.stopPropagation(),d.handler.call(d.view.$module.model,a,d.view.$getData().data,d.view),d.once&&delete d.handler)}var d=this;void 0!==d.view&&null===DD.attr(d.view,"disabled")&&(d.capture?(c(),b()):b()&&c(),0===d.events.length&&void 0===d.handler&&(DD.Event.TouchEvents[d.eventName]?DD.Event.unregist(d):d.view.removeEventListener(d.eventName,d.handleEvent)))},a.prototype.bind=function(a){var b=this;b.view.$events[b.eventName]||(DD.Event.TouchEvents[b.eventName]?DD.Event.regist(b):(b.handleEvent=function(a){b.fire(a)},b.view.addEventListener(b.eventName,b.handleEvent)),b.view.$events[b.eventName]=b)},a.prototype.unbind=function(){var a=this;if(DD.Event.TouchEvents[a.eventName])DD.Event.unregist(a);else if(a.parent){var b=a.parent.events.indexOf(a);-1!==b&&a.parent.events.splice(b)}else a.view.removeEventListener(a.eventName,a.handleEvent)},a.prototype.delegate=function(b){var c=this,d=c.view.parentNode;d||(d=document.body);var e;d.$events[c.eventName]?e=d.$events[c.eventName]:(e=new a({eventName:c.eventName,view:d}),e.bind()),-1===e.events.indexOf(c)&&e.events.push(c)},DD.Event=a,DD.Event.TouchEvents={tap:{touchstart:function(a,b){var c=a.touches[0];b.extParams={pos:{sx:c.pageX,sy:c.pageY,t:Date.now()}}},touchmove:function(a,b){var c=b.extParams.pos,d=a.touches[0],e=d.pageX-c.sx,f=d.pageY-c.sy;(Math.abs(e)>5||Math.abs(f)>5)&&(c.move=!0)},touchend:function(a,b){var c=b.extParams.pos,d=Date.now()-c.t;c.move===!0||d>200||b.fire(a)}},swipe:{touchstart:function(a,b){var c=a.touches[0],d=Date.now();b.extParams={swipe:{oldTime:[d,d],speedLoc:[{x:c.pageX,y:c.pageY},{x:c.pageX,y:c.pageY}],oldLoc:{x:c.pageX,y:c.pageY}}}},touchmove:function(a,b){var c=Date.now(),d=a.touches[0],e=b.extParams.swipe;c-e.oldTime>50&&(e.speedLoc[0]={x:e.speedLoc[1].x,y:e.speedLoc[1].y},e.speedLoc[1]={x:d.pageX,y:d.pageY},e.oldTime[0]=e.oldTime[1],e.oldTime[1]=c),e.oldLoc={x:d.pageX,y:d.pageY}},touchend:function(a,b){var c=b.extParams.swipe,d=Date.now(),e=d-c.oldTime[1]<30?0:1,f=c.oldLoc.x-c.speedLoc[e].x,g=c.oldLoc.y-c.speedLoc[e].y,h=Math.sqrt(f*f+g*g),i=d-c.oldTime[e];if(!(i>300||10>h)){var j=h/i;if(j>.05){var k="";0>f&&Math.abs(g/f)<1&&(a.v0=j,k="swipeleft"),f>0&&Math.abs(g/f)<1&&(a.v0=j,k="swiperight"),g>0&&Math.abs(f/g)<1&&(a.v0=j,k="swipedown"),0>g&&Math.abs(f/g)<1&&(a.v0=j,k="swipeup"),b.eventName===k&&b.fire(a)}}}}},DD.Event.TouchEvents.swipeleft=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swiperight=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipeup=DD.Event.TouchEvents.swipe,DD.Event.TouchEvents.swipedown=DD.Event.TouchEvents.swipe,DD.Event.regist=function(a){var b=DD.Event.TouchEvents[a.eventName];DD.isEmpty(a.touchListeners)||DD.Event.unregist(a),a.touchListeners={},b&&DD.getOwnProps(b).forEach(function(c){a.touchListeners[c]=function(d){b[c](d,a)},a.view.addEventListener(c,a.touchListeners[c])})},DD.Event.unregist=function(a){var b=DD.Event.TouchEvents[a.eventName];b&&DD.getOwnProps(a.touchListeners).forEach(function(b){a.view.removeEventListener(b,a.touchListeners[b])})}}(),function(){DD.Expression={keywords:["var","object","typeof","function","undefined","null"],handle:function(a,b,c){var d=this;if(DD.isArray(b)){var e=!1,f=(b.length,"");return b.forEach(function(b){if("string"===b.type)f+=b.src;else{var g=d.cacExpr(a,b.src,c);!e&&g[0]&&(e=!0),f+=g[1]}}),[e,f]}},initExpr:function(a){for(var b,c=this,d=new RegExp(/\{\{.+?\}\}/g),e=[],f=0;null!==(b=d.exec(a));){if(b.index>f){var g=a.substring(f,b.index);DD.isEmpty(g)||e.push({type:"string",src:g})}e.push({type:"expr",src:c.initOne(b[0].substring(2,b[0].length-2))}),f=b.index+b[0].length}if(f<a.length){var g=a.substr(f);DD.isEmpty(g)||e.push({type:"string",src:g})}if(1===e.length&&1===e[0].src[0].length){var h=e[0].src[0][0].type;if("string"===h||"number"===h||"bool"===h||"blank"===h)return e[0].src[0][0].src}return e},initOne:function(exprStr){function genStack(a){for(var b=[],c=[],d=0,e=0;e<a.length;e++)for(var f=cacSign.length-1;f>=0;f--){var g=cacSign[f].length;if(a.substr(e,g)===cacSign[f]){b.push(a.substr(d,e-d).trim()),c.push(cacSign[f]),e+=g-1,d=e+1;break}}return d<a.length&&b.push(a.substr(d)),[b,c]}function getParams(a){var b=[],c=a.substring(a.indexOf("(")+1,a.lastIndexOf(")"));if(""!==c&&""!==(c=c.trim())){var d=c.split(",");d.forEach(function(a){a=a.trim();for(var c=0;c<strArr.length;c++)if(strPrev+c===a)return void b.push({type:"string",src:strArr[c]});var d;d=isNaN(a)?{type:"field",src:a.trim()}:{type:"number",src:a},b.push(d)})}return b}function initFilter(){for(var a=0;a<stacks[1].length;a++)if("|"===stacks[1][a]){var b={type:"filter",exprs:[stacks[0][a],stacks[0][a+1]],signs:[]},c=a,d=stacks[1][a-1],e=0;if(")"===d){e++,b.exprs[0]=stacks[0][a-1],stacks[0].splice(a);for(var f=a-2;f>=0;f--)if(")"===stacks[1][f])e++;else if("("===stacks[1][f]&&0===--e){c=f;break}b.signs.unshift(d);for(var f=a-2;f>=c;f--)b.exprs.unshift(stacks[0][f]),b.signs.unshift(stacks[1][f])}stacks[0].splice(c,a-c+2,b),stacks[1].splice(c,a-c+1),a=c}}for(var me=this,cacSign=["(",")","!","|","*","/","+","-",">","<",">=","<=","==","===","&&","||","%"],regFun=new RegExp(/[\w$][\w$\d\.]*\(.*?\)/),regStr=new RegExp(/(\'.+?\')|(\".+?\")/),funPrev="$DDfun_rep_",strPrev="$DDstr_rep_",funArr=[],strArr=[],repIndex=0,r;null!==(r=regStr.exec(exprStr));)exprStr=exprStr.replace(r[0],strPrev+repIndex++),strArr.push(r[0]);for(repIndex=0;null!==(r=regFun.exec(exprStr));)exprStr=exprStr.replace(r[0],funPrev+repIndex++),funArr.push(r[0]);var stacks=genStack(exprStr),stack1=[];return stacks[0].forEach(function(item,ii){for(var i=0;i<funArr.length;i++)if(-1!==item.indexOf(funPrev+i)){var ind1=funArr[i].indexOf("("),fn=funArr[i].substr(0,ind1).trim(),pm=getParams(funArr[i]);return void stack1.push({type:"function",fn:fn,params:pm})}for(var i=0;i<strArr.length;i++)if(-1!==item.indexOf(strPrev+i))return void stack1.push({type:"string",src:item.replace(strPrev+i,strArr[i])});""===item?stack1.push({type:"blank",src:item}):isNaN(item)?"true"===item||"false"===item?stack1.push({type:"bool",src:eval(item)}):-1!==me.keywords.indexOf(item.trim())?stack1.push({type:"string",src:item}):stack1.push({type:"field",src:item.trim()}):stack1.push({type:"number",src:eval(item)})}),stacks[0]=stack1,initFilter(),stacks},cacExpr:function(module,stacks,model){function invoke(funObj){var foo,isSystem=!1;if(-1===funObj.fn.indexOf(".")){if(foo=module.methodFactory.get(funObj.fn),void 0===foo)throw DD.Error.handle("notexist1",DD.words.module+DD.words.method,funObj.fn)}else isSystem=!0,foo=eval(funObj.fn);var pa=[],change=!1;return funObj.params.forEach(function(p){switch(p.type){case"field":var v=getValue(module,p.src,model);if(v[0]&&(change=!0),v=v[1],void 0===v||null===v)throw DD.Error.handle("notexist1",DD.words.dataItem,p.src);pa.push(v);break;case"number":pa.push(eval(p.src));break;default:pa.push(p.src)}}),isSystem?[change,foo.apply(null,pa)]:[change,foo.apply(module.model,pa)]}function filter(filterObj){for(var exprs=filterObj.exprs,signs=filterObj.signs,src,r="",change=!1,i=0;i<exprs.length-1;i++){var r1=cacOne(exprs[i]);r1[0]&&(change=!0),r+=r1[1],i<signs.length&&(r+=signs[i])}if(signs.length>0)try{r=eval(r)}catch(e){}return[change,DD.Filter.handle(module,r,exprs[i].src)]}function cacOne(a){function b(a){if(!hasCac)return a;if(void 0===a||a===!0||a===!1||null===a)return a;if(DD.isString(a)){var b=a.indexOf("'");-1!==b?b>0&&(a='"'+a+'"'):((b=a.indexOf('"'))>0||-1===b)&&(a="'"+a+"'")}return a}switch(a.type){case"field":var c=getValue(module,a.src,model);return[c[0],b(c[1])];case"function":var c=invoke(a);return[c[0],b(c[1])];case"filter":var c=filter(a);return[c[0],b(c[1])];default:return[!1,a.src]}}function getValue(a,b,c){var d=c.data;return null===d||void 0===d?[!1,""]:DD.isFunction(d.$get)?d.$get(b):[!1,""]}for(var expr="",hasCac=!1,i=0;i<stacks[1].length;i++)if(""!==stacks[1][i]){hasCac=!0;break}var isChange=!1;if(stacks[0].forEach(function(a,b){var c=cacOne(a);!isChange&&c[0]&&(isChange=!0);var d=c[1],e="";b<stacks[1].length&&(e=stacks[1][b]),expr+=d+e}),hasCac)try{""!==expr&&(expr=eval(expr))}catch(e){}return"undefined"===expr&&(expr=""),[isChange,expr]}}}(),function(){function initmodel(a){var b=this;if(!a)throw DD.Error.handle("paramException","x-model");if(a=a.trim(),DD.isEmpty(a))throw DD.Error.handle("paramException","x-model");var c=b.$getDirective("model");c.value=a}function initrepeat(a){var b,c=this;if(!a)throw DD.Error.handle("paramException","x-repeat");if(a=a.trim(),DD.isEmpty(a))throw DD.Error.handle("paramException","x-repeat");var d,e;-1!==(d=a.indexOf("|"))?(b=a.substr(0,d).trim(),e=a.substr(d+1).trim()):b=a;var f=c.$getDirective("repeat");f.value=b,f.filter=e,f.done=!1;var g=document.createTextNode("");DD.replaceNode(c,g),g.$savedDoms.repeat=c,DD.Directive.initViewDirective(g,[{name:"model",value:b}]),c.$removeDirective("repeat")}function initif(a){var b=this,c=b.nextElementSibling||b.nextSibling,d=b.$getDirective("if");d.value=DD.Expression.initExpr("{{"+d.value+"}}");var e=[b];DD.isEl(c)&&c.hasAttribute("x-else")?(d.hasElse=!0,e.push(c)):d.hasElse=!1;var f=document.createTextNode("");DD.replaceNode(b,f),b.$removeDirective("if"),f.$savedDoms["if"]=e}function initelse(a){this.$removeDirective("else"),DD.remove(this)}function initshow(a){var b=this,c=b.$getDirective("show");c.value=DD.Expression.initExpr("{{"+c.value+"}}")}function initclass(value){var view=this,d=view.$getDirective("class"),obj=eval("("+value+")");if(DD.isObject(obj)){var robj={};DD.getOwnProps(obj).forEach(function(a){DD.isString(obj[a])?robj[a]=DD.Expression.initExpr("{{"+obj[a]+"}}",view.$module):robj[a]=obj[a]}),d.value=robj}}function initfield(){var a,b,c=this,d=c.$getDirective("field").value;b=-1!==(a=d.indexOf("|"))?d.substr(0,a):d;var e=c.tagName.toLowerCase(),f="input";"input"!==e||"checkbox"!==c.type&&"radio"!==c.type||(f="change"),"radio"!==c.type&&(c.$attrs.value=DD.Expression.initExpr("{{"+d+"}}",c)),new DD.Event({view:c,eventName:f,handler:function(a,c,d){"checkbox"===d.type&&(DD.attr(d,"yes-value")===d.value?d.value=DD.attr(d,"no-value"):d.value=DD.attr(d,"yes-value")),c[b]=d.value}})}function domodel(a,b){var c=this;b||(c.$model.data=null,c.$model=c.$getData())}function dorepeat(a,b){var c=this;DD.isEmpty(a)&&(a=c.$getDirective("repeat")),b||(b=c.$getData());for(var d=[],e=c.nextElementSibling||c.nextSibling;e&&e.$fromNode===c;)d.push(e),e=e.nextElementSibling||e.nextSibling;if(void 0!==b.data&&DD.isArray(b.data)&&0!==b.data.length){var f=[];f=a.filter?DD.Filter.handle(c.$module,b.data,a.filter):b.data;for(var g,g=c,h=d.length-1;h>=f.length;h--)DD.remove(d[h]);f.forEach(function(a,b){var e;b<d.length?e=d[b]:(e=DD.cloneNode(c.$savedDoms.repeat),e.$fromNode=c,DD.insertAfter(e,g)),a.$index!==b&&(a.$set("$index",b),e.$forceRender=!0),(c.$forceRender||e.$forceRender)&&e.$setForceRender(!0),e.$model.data=a,g=e})}else for(var h=d.length-1;h>=0;h--)DD.remove(d[h])}function doif(directive,model){var view=this;DD.isEmpty(directive)&&(directive=view.$getDirective("if")),model||(model=view.$getData());var fr=view.$forceRender||view.$module.forceRender;if(DD.isArray(directive.value))var re=DD.Expression.handle(view.$module,directive.value,model),r=re[1];else r=directive.value;DD.isString(r)&&(r=eval(r));var node;if(r){if(directive.yes===!0)return;node=view.$savedDoms["if"][0]}else if(directive.hasElse){if(directive.yes===!1)return;node=view.$savedDoms["if"][1]}if(directive.yes=r,view.nextSibling&&view.nextSibling.$fromNode===view&&DD.remove(view.nextSibling),void 0!==node){var n=DD.cloneNode(node);DD.insertAfter(n,view),n.$fromNode=view,n.$setForceRender(!0)}}function doclass(a,b){var c=this;if(c.nodeType===Node.ELEMENT_NODE){DD.isEmpty(a)&&(a=c.$getDirective("class"));var d=a.value;b||(b=c.$getData());var e=c.$forceRender||c.$module.forceRender;DD.getOwnProps(d).forEach(function(a){var f=d[a];if(DD.isArray(d[a])){var g=DD.Expression.handle(c.$module,d[a],b);if(!g[0]&&!e)return;f=g[1]}f=f&&"false"!==f?!0:!1,f?DD.addClass(c,a):DD.removeClass(c,a)})}}function doshow(a,b){function c(){a.yes?(DD.css(e,"display",a.display),e.$setForceRender(!0)):DD.css(e,"display","none")}function d(){var c=!0;if(DD.isArray(a.value)){var d=DD.Expression.handle(e.$module,a.value,b);if(!d[0]&&!e.$forceRender&&!e.$module.forceRender)return!1;c=d[1]}else c=a.value;if(c=c&&"false"!==c?!0:!1){if(a.yes===!0)return!1}else if(a.yes===!1)return!1;return a.yes=c,!0}var e=this;DD.isEmpty(a)&&(a=e.$getDirective("show")),b||(b=e.$getData());var f=d();a.display?f&&c():setTimeout(function(){if(void 0===a.display){var b=DD.css(e,"display");(""===b||"none"===b)&&(b="inline"),a.display=b}f&&c()},0)}function dofield(a,b){var c=this,d=c.type,e=c.tagName.toLowerCase();if("radio"===d||"checkbox"===d||"select"===e){b||(b=c.$getData());var f=c.$forceRender||c.$module.forceRender,g=b.data.$get(a.value);if(g[0]||f){var h=g[1];if("radio"===d){var i=c.value;h==i?DD.attr(c,"checked","checked"):c.removeAttribute("checked")}else if("checkbox"===d){var j=DD.attr(c,"yes-value");h+""==j?(DD.attr(c,"checked","checked"),c.value=j):(c.removeAttribute("checked"),c.value=DD.attr(c,"no-value"))}else"select"===e&&setTimeout(function(){c.value=h},0)}}}DD.Directive={directives:{model:{preOrder:1,once:!1,sys:!0,init:initmodel,handler:domodel},repeat:{preOrder:2,once:!1,sys:!0,init:initrepeat,handler:dorepeat},"class":{preOrder:5,once:!1,sys:!0,init:initclass,handler:doclass},"if":{preOrder:5,once:!1,sys:!0,init:initif,handler:doif},"else":{preOrder:5,once:!1,sys:!0,init:initelse},show:{preOrder:5,sys:!0,init:initshow,handler:doshow},field:{preOrder:5,init:initfield,handler:dofield}},create:function(a){var b=this;if(!DD.isObject(a)||DD.isEmpty(a))throw DD.Error.handle("invoke","createDirective",1,"object");if(DD.isEmpty(a.name))throw DD.Error.handle("invoke","createDirective","name","string");if(DD.Directive.directives[a.name])throw DD.Error.handle("exist1",DD.words.directive,a.name);if(a.init&&!DD.isFunction(a.init))throw DD.Error.handle("invoke","createDirective","init","function");if(a.handler&&!DD.isFunction(a.handler))throw DD.Error.handle("invoke","createDirective","handler","function");(void 0===a.preOrder||a.preOrder<10)&&(a.preOrder=10),a.once=a.once||!1,b.directives[a.name]=a},remove:function(a){var b=this,c=DD.Directive.directives[name];if(c&&c.sys)throw DD.Error.handle("notremove1",DD.words.directive,name);delete b.directives[a]},get:function(a){return this.directives[a]},sortDirectives:function(a){var b=this,c=a.$directives;c.length>1&&c.sort(function(a,c){var d=a.name,e=c.name,f=b.directives[d],g=b.directives[e];return f.preOrder-g.preOrder})},initViewDirectives:function(a){var b=this,c=DD.getAttrs(a,/^x-/);c.forEach(function(b){a.removeAttribute(b.name)}),c.forEach(function(c){var d=c.name.substr(2),e=c.value;a.$directives.push({name:d,value:e}),void 0!==b.directives[d]&&DD.isFunction(b.directives[d].init)&&b.directives[d].init.call(a,e)}),b.sortDirectives(a)},initViewDirective:function(a,b){var c=this;b.forEach(function(b){a.$hasDirective(b.name)||a.$directives.push(b);b.value;void 0!==c.directives[b.name]&&DD.isFunction(c.directives[b.name].init)&&c.directives[b.name].init.call(a,b.value)}),c.sortDirectives(a)},handle:function(a,b){var c=this,d=[];if(a.$directives.forEach(function(e){var f=e.name,g=c.directives[f];void 0!==g&&DD.isFunction(g.handler)&&(g.handler.call(a,e,b),g.once===!0&&d.push(a.$directives.indexOf(e)))}),d.length>0)for(var e=d.length-1;e>=0;e--)a.$directives.splice(d[e],1)}}}(),function(){DD.Filter={cantEditFilters:["date","currency","number","tolowercase","touppercase","orderBy","filter"],filters:{date:function(a,b){if(DD.isEmpty(a))return"";if(!DD.isArray(b))throw DD.Error.handle("paramException",DD.words.filter,"date");var c=b[0];return c=c.substr(1,c.length-2),DD.formatDate(a,c)},currency:function(a,b){var c;return DD.isArray(b)&&(c=b[0]),isNaN(a)?"":("string"==typeof a&&(a=parseFloat(a)),DD.isEmpty(c)&&(c="¥"),c+DD.Filter.filters.number(a,[2]))},number:function(a,b){if(!DD.isArray(b))throw DD.Error.handle("paramException",DD.words.filter,"number");var c=b[0]||0;if(isNaN(a)||0>c)return"";"string"==typeof a&&(a=parseFloat(a));for(var d=1,e=0;c>e;e++)d*=10;return(Math.round(a*d)/d).toFixed(c)},tolowercase:function(a){if(DD.isEmpty(a))return"";if(!DD.isString(a)||DD.isEmpty(a))throw DD.Error.handle("invoke1",DD.words.filter+" tolowercase",0,"string");return a.toLowerCase()},touppercase:function(a){if(DD.isEmpty(a))return"";if(!DD.isString(a)||DD.isEmpty(a))throw DD.Error.handle("invoke1",DD.words.filter+" touppercase",0,"string");return a.toUpperCase()},orderBy:function(a,b){if(!DD.isArray(b))throw DD.Error.handle("invoke1",DD.words.filter+" orderBy",0,"array");var c=b[0],d=b[1]||"asc",e=a.concat([]);return e.sort(function(a,b){return"asc"===d?a[c]>b[c]:a[c]<b[c]}),e},select:function(array,pa){var me=this;if(!DD.isArray(array))throw DD.Error.handle("invoke1",DD.words.filter+" filter",0,"array");if(DD.isEmpty(pa))throw DD.Error.handle("invoke3",DD.words.filter+" filter",0,"array");var handler={odd:function(a){for(var b=[],c=0;c<a.length;c++)c%2===1&&b.push(a[c]);return b},even:function(a){for(var b=[],c=0;c<a.length;c++)c%2===0&&b.push(a[c]);return b},range:function(a,b){var c,d;if(isNaN(b[0]))throw DD.Error.handle("paramException",DD.words.filter,"filter range");if(c=parseInt(b[0]),isNaN(b[1]))throw DD.Error.handle("paramException",DD.words.filter,"filter range");if(d=parseInt(b[1]),c>d)throw DD.Error.handle("paramException",DD.words.filter,"filter range");return a.slice(c,d+1)},index:function(a,b){if(!DD.isArray(a)||!DD.isArray(b))throw DD.Error.handle("paramException",DD.words.filter,"filter index");var c=[],d=a.length;return b.length>0&&b.forEach(function(b){isNaN(b)||(parseInt(b),b>=0&&d>b&&c.push(a[b]))}),c},func:function(a,b){if(!DD.isArray(a)||DD.isEmpty(b))throw DD.Error.handle("paramException",DD.words.filter,"filter func");var c=me.methodFactory.get(b[0]);return DD.isFunction(c)?c(a):a},value:function(arr,param){if(!DD.isArray(array)||DD.isEmpty(param))throw DD.Error.handle("paramException",DD.words.filter,"filter value");var ret=[];if("{"===param[0]&&"}"===param[param.length-1]&&(param=eval("("+param+")")),DD.isObject(param)){var keys=DD.getOwnProps(param);return arr.filter(function(a){for(var b=0;b<keys.length;b++){var c=a[keys[b]],d=param[keys[b]];if("string"==typeof c&&-1!==c.indexOf(d)||c===d)return!0}return!1})}return arr.filter(function(a){for(var b=DD.getOwnProps(a),c=0;c<b.length;c++){var d=a[b[c]];if(DD.isString(d)&&-1!==d.indexOf(param))return a}})}},type=pa[0].trim();if(handler.hasOwnProperty(type)||(type="value"),"range"===type||"index"===type||"func"===type){if(pa.length<2)throw DD.Error.handle("paramException",Dd.words.filter);return handler[type].call(me,array,pa.slice(1))}return"value"===type?handler[type].call(me,array,pa[0]):handler[type].call(me,array)}},handle:function(a,b,c){var d=this;if(DD.isEmpty(b))return"";if(DD.isEmpty(c))return b;for(var e,f="$DD_rparam_",g=new RegExp(/(\{.+?\})|(".+?")|('.+?')/g),h=[],i=0;null!==(e=g.exec(c));)h.push(e[0]),
c=c.replace(e[0],f+i++);var j=c.split("|");return j.forEach(function(c){if(!DD.isEmpty(c.trim())){for(var e=c.split(":"),g=0;g<e.length;g++)e[g]=e[g].trim();var i=e[0];if(h.length>0)for(var j=1;j<e.length;j++)for(var g=0,k=h.length;k>g;g++)e[j]=e[j].trim().replace(f+g,h[g]);DD.isFunction(d.filters[i])&&(b=d.filters[i].call(a,b,e.slice(1)))}}),b},add:function(a,b){var c=this;if(-1!==c.cantEditFilters.indexOf(a))throw DD.error.handle("notupd",DD.words.system+DD.words.filter,a);if(void 0!==c.filters[a])throw DD.Error.handle("exist1",DD.words.filter,a);c.filters[a]=b},remove:function(a){var b=this;if(-1!==b.cantEditFilters.indexOf(a))throw DD.Error.handle("notupd",DD.words.system+DD.words.filter,a);if(void 0===b.filters[a])throw DD.Error.handle("notexist1",DD.words.filter,a);delete b.filters[a]}}}(),function(){var a=function(){var a=this;a.methods={}};a.prototype={add:function(a,b){var c=this;if(DD.isEmpty(a))throw DD.Error.handle("invoke","DD.MethodFactory.add",0,"string");if(!DD.isFunction(b))throw DD.Error.handle("invoke","DD.MethodFactory.add",0,"function");if(DD.isFunction(c.methods[a]))throw DD.Error.handle("exist1",DD.words.method,a);c.methods[a]=b},remove:function(a){var b=this;if(DD.isEmpty(a))throw DD.Error.handle("invoke","DD.MethodFactory.remove",0,"string");if(void 0===b.methods[a])throw DD.Error.handle("notexist1",DD.words.method,a);delete b.methods[a]},get:function(a){return this.methods[a]}},DD.MethodFactory=a}(),function(){var a=function(a){var b=this,c=a.data;return b.init=!0,b.module=a.module,DD.isObject(c)?b.createObjectModel(c):DD.isArray(c)&&b.createArrayModel(c),b.data=c,c.$model=b,b.change(c),delete b.init,b.module.model=b,b},b={$fields:void 0,$set:function(a,b){var c=this;(DD.isObject(b)||DD.isArray(b))&&(b=DD.clone(b));for(var d,e=a.split("."),f=0;f<e.length-1;f++)if(d=e[f],c=c[d],!c)throw DD.Error.handle("notexist1",DD.words.dataItem,d);d=e[f],void 0===c[d]&&(c.$model.init=!0,Object.defineProperty(c,a,{set:function(b){c.$model.setProp(c,a,b)},get:function(){return c.$model.getProp(c,a)}})),c[d]=b,delete c.$model.init},$get:function(a){for(var b,c=this,d=a.split("."),e=0;e<d.length&&c;e++)if(d[e].lastIndexOf("]")===d[e].length-1){var f=d[e].split("[");c=c[f[0]],f.shift(),f.forEach(function(a){var b=a.substr(0,a.length-1);c=c[parseInt(b)]})}else c.$fields&&(b=c.$fields["$old_"+d[e]],c=c[d[e]]);c===this&&(c=void 0);var g=!1;return(void 0!==b||void 0===c)&&(g=!0),[g,c]},$isChanged:function(a){function b(a){if(DD.isObject(a))for(var c=DD.getOwnProps(a),d=0;d<c.length;d++){var e=a[c[d]];if(DD.isObject(e)||DD.isArray(e))return e.$changed?!0:b(e)}else if(DD.isArray(a))for(var d=0;d<a.length;d++){var e=a[d];if(DD.isObject(e)||DD.isArray(e))return e.$changed?!0:b(e)}return!1}return a?this.$changed?!0:b(this):this.$changed||!1},$up:function(a){function b(a,c){if("object"!=typeof c||DD.isEmpty(c))return!1;e.push(c);var d=!1;if(DD.isArray(c)){for(var f=0;f<c.length;f++)if("object"==typeof c[f]){if(a===c[f])return!0;if(d=b(a,c[f]))return!0}}else for(var g=DD.getOwnProps(c),f=0;f<g.length;f++)if(0!==g[f].indexOf("$")){var h=c[g[f]];if("object"!=typeof h)continue;if(h===a)return!0;if(d=b(a,h))return!0}return d||e.pop(),!1}var c=this,d=c.$model.data,e=[];if(b(c,d),DD.isNumber(a)){if(e.length>a)return e[e.length-a]}else{var f=-1;if(e.forEach(function(b,c){b.hasOwnProperty(a)&&(f=c)}),-1!=f)return e[f]}return d},$clone:function(a){return DD.clone(this)}};a.prototype.setProp=function(a,b,c){var d=this;if(!b||"$"!==b.indexOf(0)){a.$model=d,void 0===a.$fields&&(a.$fields={});var e=a.$fields[b]!==c;e&&(DD.isObject(c)?(d.init=!0,d.createObjectModel(c),a.$fields[b]=c):DD.isArray(c)?(d.createArrayModel(c),a.$fields[b]=c):(d.init?a.$fields["$old_"+b]=null:a.$fields["$old_"+b]=a.$fields[b],a.$fields[b]=c),d.change(a))}},a.prototype.getProp=function(a,b){return a.$fields?a.$fields[b]:void 0},a.prototype.change=function(a){a&&(a.$changed=!0,DD.Renderer.add(this.module))},a.prototype.clean=function(a){var b=this;a=a||b.data,delete a.$changed,DD.isObject(a)?DD.getOwnProps(a).forEach(function(c){"$"===c[0]||DD.isFunction(a[c])||(DD.isObject(a[c])||DD.isArray(a[c])?b.clean(a[c]):a.$fields&&delete a.$fields["$old_"+c])}):DD.isArray(a)&&a.forEach(function(a){DD.isObject(a)&&b.clean(a)})},a.prototype.setDefault=function(a){var b=this;a=a||b.data,DD.isObject(a)?DD.getOwnProps(a).forEach(function(c){"$"===c[0]||DD.isFunction(a[c])||(DD.isObject(a[c])||DD.isArray(a[c])?b.setDefault(a[c]):a.$fields["$old_"+c]=null)}):DD.isArray(a)&&a.forEach(function(a){DD.isObject(a)&&b.setDefault(a)})},a.prototype.createObjectModel=function(a){var c=this;DD.assign(a,b),a.$model=c,a.$changed=!0,c.init=!0,DD.getOwnProps(a).forEach(function(b){if("$"!==b[0]&&!DD.isFunction(a[b])){var d=a[b];Object.defineProperty(a,b,{set:function(d){c.setProp(a,b,d)},get:function(){return c.getProp(a,b)}}),a[b]=d}})},a.prototype.createArrayModel=function(a){var c=this;a.$model=c,DD.assign(a,b),a.$changed=!0;for(var d=0;d<a.length;d++){var e=a[d];DD.isObject(e)&&c.createObjectModel(e),DD.isArray(e)&&c.createArrayModel(e)}var f=["push","unshift","splice","pop","shift","reverse","sort"];f.forEach(function(b){a[b]=function(){Array.prototype[b].apply(a,arguments);var d=[];switch(b){case"push":d=arguments;break;case"unshift":d=arguments;break;case"splice":if(arguments.length>2)for(var e=2;e<arguments.length;e++)d.push(arguments[e])}for(var e=0;e<d.length;e++){var f=d[e];DD.isObject(f)&&c.createObjectModel(f),DD.isArray(f)&&c.createArrayModel(f)}c.change(a)}})},DD.Model=a}(),function(){var a=function(a){var b=this;return b.name=a.name||"DDModule_"+DD.genId(),b.methodFactory=new DD.MethodFactory,b.modules=[],b.compiled=!1,b.inited=!1,b.onReceive=a.onReceive,b.onInit=a.onInit,b.fromModules=a.fromModules,b.onBeforeFirstRender=a.onBeforeFirstRender,b.onBeforeRender=a.onBeforeRender,b.onRender=a.onRender,b.onFirstRender=a.onFirstRender,b.initConfig=DD.merge({delayInit:!1},a),b.el=b.initConfig.el,DD.isEmpty(a.methods)||DD.getOwnProps(a.methods).forEach(function(c){b.methodFactory.add(c,a.methods[c])}),b.initConfig.delayInit||b.init(a),a.root===!0&&(DD.App=b),b};a.prototype.init=function(a){var b=this,c=b.initConfig;b.parent=c.parent,b.virtualDom=DD.newEl("div");var d,e;if(b.parent){if(DD.isString(b.parent)){var f=b.parent;if(b.parent=DD.Module.get(f),!b.parent)throw DD.Error.handle("notexist1",DD.words.module,f)}b.parent.modules.push(b),d=b.parent.rendered?b.parent.view:b.parent.virtualDom}else d=document.body;e=DD.get(c.el,!1,d),e&&e.childNodes&&DD.transChildren(e,b.virtualDom),b.load(function(d,e){if(!DD.isEmpty(e)){var f=DD.newEl("div");f.innerHTML=e,DD.transChildren(f,b.virtualDom)}b.compile(),d=d||{},new DD.Model({data:d,module:b}),DD.isArray(c.modules)&&c.modules.forEach(function(a){b.addModule(a)}),DD.isFunction(c.onInit)&&c.onInit.call(b.model),DD.isFunction(a)&&a(b),delete b.initConfig,DD.Renderer.add(b)}),b.inited=!0},a.prototype.load=function(a){function b(){DD.isFunction(a)&&0===i&&a(e,f)}function c(){DD.isArray(h.requires)&&h.requires.length>0?(h.requires.forEach(function(a,b){var c,e,f="js";switch(DD.isObject(a)?(e=a.path,f=a.type||f,a.obj&&(c=a.obj)):"string"==typeof a&&(e=a),f){case"css":DD.load("css",e);break;default:i++,DD.load("js",e,function(){0===--i&&d()},c)}}),0===i&&d()):d()}function d(){if(DD.isObject(h.data)?e=h.data:DD.isEmpty(h.dataUrl)||(g.setData({}),i++,DD.request({url:h.dataUrl,type:"json",successFunc:function(a){e=a,0===--i&&b()}})),DD.isEmpty(h.template)){if(!DD.isEmpty(h.templateUrl)){var a=h.templateUrl;DD.config&&!DD.isEmpty(DD.config.appPath)&&(a=DD.config.appPath+"/"+a),i++,DD.request({url:a,successFunc:function(a){f=a,0===--i&&b()}})}}else f=h.template;0===i&&b()}var e,f,g=this,h=g.initConfig,i=0;c()},a.prototype.compile=function(a){var b,c,d=this;d.className&&void 0!==(b=DD.Module.getClass(d.className))&&b.virtualDom?d.virtualDom=b.virtualDom:(c=DD.Compiler.compile(d.virtualDom,d),b&&(b.virtualDom=c)),d.compiled=!0},a.prototype.render=function(a,b){function c(a){return a.view||(a.parent?(a.parent.view||c(a.parent),a.parent.view&&(a.view=DD.get(a.el,!1,a.parent.view))):a.view=DD.get(a.el,!1,document.body)),a.view}var d=this;if(d.compiled&&(!d.parent||d.parent.rendered)&&(c(d),d.view&&(d.view.$isView||(DD.merge(d.view,DD.extendElementConfig),d.view.$isView=!0),!d.needData||d.model))){if(0===d.view.childNodes.length){DD.isFunction(d.onBeforeFirstRender)&&d.onBeforeFirstRender.call(d.model);var e=DD.cloneNode(d.virtualDom);DD.Renderer.renderView(e,d),DD.transChildren(e,d.view),d.view.$containModule=d,DD.isFunction(d.onFirstRender)&&setTimeout(function(){d.onFirstRender.call(d.model)},0),d.renderChildren=!0}else DD.isFunction(d.onBeforeRender)&&d.onBeforeRender.call(d.model),DD.Renderer.renderView(d.view,d),DD.isFunction(d.onRender)&&setTimeout(function(){d.onRender.call(d.model)},0);d.rendered=!0,d.model&&d.model.clean(),d.renderChildren&&d.modules.forEach(function(a){a.renderChildren=!0,a.render()}),delete d.renderChildren,delete d.forceRender,DD.Router&&setTimeout(function(){DD.Router.setRouteFinish(d),DD.Router.linkLoad()},0)}},a.prototype.destroy=function(){delete DD.Module.moduleFactory[this.name],DD.Renderer.remove(this)},a.prototype.addModule=function(a){var b=this;if(!DD.isObject(a))throw DD.Error.handle("invoke1","addModule",0,"object");return a.parent=b,DD.Module.create(a)},a.prototype.setData=function(a){var b=this;(DD.isObject(a)||DD.isArray(a))&&(a=DD.clone(a),b.model&&!DD.isEmpty(b.model.data)&&DD.getOwnProps(b.model.data).forEach(function(c){"$"===c[0]&&(a[c]=b.model.data[c])}),new DD.Model({data:a,module:b}))},a.prototype.broadcast=function(a){function b(d){d.rendered?d.onReceive.call(d.model,c.name,a):setTimeout(b,20)}var c=this,d=c.name,e=[];c.parent&&(e.push(c.parent),e=e.concat(c.parent.modules)),e=e.concat(c.modules),e.forEach(function(a){if(a!==c&&DD.isFunction(a.onReceive)){var e=!0;DD.isArray(a.fromModules)&&0!==a.fromModules.length&&-1===a.fromModules.indexOf(d)&&(e=!1),e&&b(a)}})},a.prototype.send=function(a,b){function c(){e.rendered?e.onReceive.call(e.model,d.name,b):setTimeout(c,20)}var d=this;if(!DD.isString(a))throw DD.Error.handle("invoke","send","moduleName","string");if(void 0===b)throw DD.Error.handle("invoke","send","moduleName","not null");var e=DD.Module.get(a);if(!e)throw DD.Error.handle("notexist1",DD.words.module,a);DD.isFunction(e.onReceive)&&c()},a.prototype.setForceRender=function(a){var b=this;b.forceRender=a,b.modules.forEach(function(b){b.setForceRender(a)})},a.prototype.getScroller=function(a){function b(a){if(a.$hasDirective("scroller"))return a;for(var c=0;c<a.children.length;c++){var d=b(a.children[c]);if(d)return d}}var c=this;if(c.view){if(!a)return b(c.view);for(var d=c.view.querySelectorAll(a),e=0;e<d.length;e++)if(d[e].$hasDirective("scroller"))return d[e]}},DD.assign(a,{classFactory:{},moduleFactory:{},define:function(a){var b=this,c=a.className;if(!c)throw DD.Error.handle("invoke","define","className","string");if(b.classFactory[c])throw DD.Error.handle("exist1",DD.words.moduleClass,c);return b.classFactory[c]=DD.merge({virtualDom:null},a),b.classFactory[c]},getClass:function(a){return this.classFactory[a]},create:function(a){var b=this;if(a.name&&b.get(a.name))throw DD.Error.handle("exist1",DD.words.module,a.name);var c;if(DD.isEmpty(a.className))c=a;else{var d=b.getClass(a.className);void 0!==d&&(c=DD.assign({},d),c=DD.assign(c,a))}var e=new DD.Module(c);return b.moduleFactory[e.name]=e,e},get:function(a){return this.moduleFactory[a]}}),DD.assign(DD,{createModule:function(a){return DD.isArray(a)?void a.forEach(function(a){DD.Module.create(a)}):DD.Module.create(a)},defineModule:function(a){return DD.Module.define(a)}}),DD.Module=a}(),DD.extendElementConfig={$module:null,$containModule:null,$isRouterView:!1,$directives:[],$savedDoms:{},$model:{},$attrs:{},$exprs:[],$isView:!0,$events:{},$routeConfig:{},$forceRender:!1,$hasDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return!0;return!1},$getDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a)return c[d];return null},$removeDirective:function(a){var b=this,c=b.$directives;if(DD.isArray(c))for(var d=0;d<c.length;d++)if(c[d].name===a){c.splice(d);break}},$getData:function(){var a=this;if(!a.$isView)return null;var b,c,d;if(a.$containModule)b=a.$containModule.model.data;else if(a.$model&&a.$model.data)b=a.$model.data,c=a.$model.index,d=a.$model.oldIndex;else if(a.$module&&a.$module.model&&a.$module.model.data){for(var e=a;e&&e.$isView&&e!==a.$module.view;e=e.parentNode)if(e.$model&&e.$model.data){c=e.$model.index,b=e.$model.data,d=e.$model.oldIndex;break}if(a.$hasDirective("model")){var f=a.$getDirective("model").value;b?DD.isObject(b)&&(DD.isEmpty(f)||(b=b.$get(f)[1])):b=a.$module.model.data.$get(f)[1]}b||a.$hasDirective("model")||(b=a.$module.model.data)}return{data:b}},$setForceRender:function(a){var b=this;if(b.$forceRender=a,b.childNodes)for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c];d.$isView&&d.$setForceRender(a)}}},function(){function a(){DD.Renderer.render(),requestAnimationFrame?requestAnimationFrame(a):setTimeout(a,DD.config.renderTick)}DD.Renderer={waitList:[],add:function(a){var b=this;if(-1===b.waitList.indexOf(a)){if(void 0===a.prio)for(var c=1,d=a.parent;void 0!==d;)c++,d=d.parent;a.prio=c,b.waitList.push(a),b.waitList.sort(function(a,b){return a.prio-b.prio})}},remove:function(a){var b;-1!==(b=me.waitList.indexOf(a))&&me.waitList.splice(b,1)},render:function(){var a=this;if(0!==a.waitList.length)for(var b=0;b<a.waitList.length;b++){var c=a.waitList[b];a.waitList.splice(b--,1),c.render()}},renderView:function(a,b,c){function d(a,f){if(f||(a.$module=b),!a.$containModule||f){if(a.$isView){!a.$rendered&&DD.isEl(a)&&e(a),a.$hasDirective("model")&&DD.Directive.directives.model.handler.call(a,null);var g=a.$getData();if(c&&(a.$model?a.$model.data=rendererData:a.$model={data:rendererData},a.$setForceRender(!0)),void 0===g.data||g.data.$isChanged&&g.data.$isChanged(!0)||a.$forceRender||b.forceRender){if(DD.isEl(a)){var h=[];DD.getOwnProps(a.$attrs).forEach(function(c){var d=DD.Expression.handle(b,a.$attrs[c],g);if(d[0]||a.$forceRender||b.forceRender){var e=d[1];"x-"===c.substr(0,2)?h.push({name:c.substr(2),value:e}):DD.attr(a,c,e)}}),h.length>0&&DD.Directive.initViewDirective(a,h)}a.$directives.length>0&&DD.Directive.handle(a,g)}else a.$hasDirective("plugin")&&DD.Directive.directives.plugin.handler.call(a);var i=a.$getDirective("show");if((!i||i.yes)&&a.childNodes)for(var j=0;j<a.childNodes.length;j++)(a.$isView||g.data.$changed)&&d(a.childNodes[j]);a.$rendered=!0,delete a.$forceRender}else if(b.model&&b.model.data&&a.nodeType===Node.TEXT_NODE&&a.$exprs){var g=a.parentNode.$getData();if(g.data&&g.data.$isChanged(!0)||a.parentNode.$forceRender||b.forceRender){var k=DD.Expression.handle(b,a.$exprs,g);if(!k[0]&&!a.parentNode.$forceRender&&!b.forceRender)return;for(var l=a.nextSibling;l&&l.$genNode;){var m=l.nextSibling;DD.remove(l),l=m}var n=/\<.+?\/?\>/.test(k[1]);if(n){var o=document.createElement("div");o.innerHTML=k[1],DD.Compiler.compile(o,b);for(var p=document.createDocumentFragment(),j=0;j<o.childNodes.length;){var m=o.childNodes[j];m.$genNode=!0,p.appendChild(o.childNodes[j])}DD.insertAfter(p,a)}else a.textContent=k[1]}}return a}}function e(a){var c=DD.getAttrs(a,/^e-/);c.length>0&&c.forEach(function(c){var d=c.value.split(":"),e=b.methodFactory.get(d[0]);if(e){var f=c.name.substr(2),g={view:a,eventName:f,handler:e};if(d.length>1)for(var h=1;h<d.length;h++)g[d[h]]=!0;new DD.Event(g),a.removeAttribute(c.name)}})}d(a,!0)}},a()}(),function(){DD.Compiler={compile:function(a,b){function c(a){DD.merge(a,DD.extendElementConfig),a.$module=b,DD.getAttrsByValue(a,/\{\{.+?\}\}/).forEach(function(c){b.needData=!0,a.$attrs[c.name]=DD.Expression.initExpr(c.value,a),a.removeAttribute(c.name)}),DD.Directive.initViewDirectives(a),b&&a.$hasDirective("model")&&(b.needData=!0);for(var d=a.childNodes,e=0;e<d.length;e++){var f=d[e];switch(f.nodeType){case Node.TEXT_NODE:" "!==f.textContent&&/\{\{.+\}\}?/.test(f.textContent)&&(b&&(b.needData=!0),f.$exprs=DD.Expression.initExpr(f.textContent),f.textContent=" ");break;case Node.COMMENT_NODE:a.removeChild(f),e--;break;default:c(f)}}return a}return c(a)}}}(),DD.Error={handle:function(a){var b=(new RegExp(/\{.+?\}/),DD.ErrorMsgs[a]);if(void 0===b)return"未知错误";for(var c=[b],d=1;d<arguments.length;d++)c.push(arguments[d]);return DD.compileStr.apply(DD,c)}},function(){function a(a){if("activeroute"!==DD.attr(a,"role")){var b,c;for(c=a.parentNode;!b&&c;c=c.parentNode){for(var d=DD.get("[path]",!0,c),e=0;e<d.length;e++){var f=d[e];if(f!==a&&f&&f.$routeConfig.active){var g=f.$getData().data;if(g&&g[f.$routeConfig.active]){b=f;break}}}if(c===a.$module.view)break}if(b){b.removeAttribute("role");var h=b.$routeConfig.active;if(h){var i=b.$getData().data;i&&i.$set(h,!1)}}var h=a.$routeConfig.active;if(h){var j=a.$getData();j.data&&j.data.$set(h,!0),DD.attr(a,"role","activeroute")}}}function b(a){return DD.Router.root+a}DD.Router={routes:[],links:[],root:"",currentLinks:[],donop:!1,loading:!1,switching:!1,"switch":{style:"none",time:.5},currentState:null,history:0,histories:[],currentPath:void 0,defaultEnter:void 0,defaultLeave:void 0,addRoute:function(a){var b=this;a.parent||b.routes.push(a)},removeRoute:function(a){var b,c=this;b=a.parent?a.parent.routes:c.routes,b.splice(b.indexOf(a),1)},setRouteFinish:function(a){var b=this;b.current&&b.current.module===a&&(b.current.loading=!1)},linkLoad:function(){var a=this;if(!a.current||!a.current.loading)if(a.links.length>0){var b=a.links.shift();b.start()}else a.loading=!1},find:function(a){var b=this,c=b.getRouteLink(a);return c.length>0?c[c.length-1]:null},getRouteLink:function(a){function b(a,c){if(!DD.isArray(a)||DD.isEmpty(c))return null;for(var e,f=0;f<a.length;f++){var g=a[f];if(g.path===c)return d.push(g),g;0===c.indexOf(g.path+"/")&&(!e||e.path.length<g.path.length)&&(e=g)}if(e){d.push(e);var h,i=c.substr(e.path.length),j=i.substr(1).split("/");if(DD.isArray(e.routes)&&(h=b(e.routes,i)),null!==h)return h;if("param"===e.type){for(var k=j.length<=e.paramNames.length?j.length:e.paramNames.length,l={},f=0;k>f;f++)l[e.paramNames[f]]=j[f];if(e.newData=l,j.length<=e.paramNames.length)return e;if(j.splice(0,e.paramNames.length),i="/"+j.join("/"),DD.isArray(e.routes))return b(e.routes,i)}}return null}var c=this,d=[];return b(c.routes,a),d},start:function(a,c,d){function e(a){null!==a&&"object"==typeof a&&(a.view=null,DD.isArray(a.modules)&&a.modules.forEach(function(a){e(a)}))}var f=this;if(a=a.trim(),!DD.isEmpty(a)){if(f.currentPath===a)return!0;c!==!1&&(c=!0),f.links=[];var g=f.getRouteLink(a),h=!1,i=null;if(f.currentLinks.length>0){for(var j=-1,k=g.length>f.currentLinks.length?g.length:f.currentLinks.length,j=k,l=0;k>l;l++)if(f.currentLinks[l]!==g[l]){j=l;break}j===g.length&&f.currentLinks.length>=g.length?j--:j===f.currentLinks.length&&(h=!0),i=g[j],g.splice(0,j);for(var l=f.currentLinks.length-1;l>=j;l--){var m=f.currentLinks[l];if(!m)break;e(m.module),DD.Router.defaultLeave&&DD.Router.defaultLeave.call(m,m.module.model),DD.isFunction(m.onLeave)&&m.onLeave(m.module.model),f.currentLinks.pop()}f.currentLinks=f.currentLinks.concat(g)}else f.currentLinks=[].concat(g);if(f.loading||"none"!==f["switch"].style&&f.switching)if(h)f.links=f.links.concat(g);else if(f.setRouteFinish(f.current.module),i){var n=f.links.indexOf(i);-1!==n&&f.links.splice(n+1,f.links.length),f.links=f.links.concat(g)}else f.links=g;else f.links=g;for(var l=0;l<f.links.length;l++)f.links[l].data=f.links[l].newData,delete f.links[l].newData;if(f.currentPath=a,0===f.links.length)throw DD.Error.handle("notexist1",DD.words.route,a);var o=f.links[f.links.length-1],p=o.getShowPath();if((p===f.showPath||f.links[0].replace===!0)&&(d=!0),f.showPath=p,c){var q=b(p);d?(f.currentState.path=a,history.replaceState(f.currentState,"",q),f.histories.length>0&&(f.histories[f.histories.length-1]=a)):(f.currentState={path:a,index:f.history++,forward:!0},history.pushState(f.currentState,"",q),f.histories.push(a)),f.backward=!1}return f.loading=!0,f.linkLoad(),!0}},go:function(a,b){var c=this;if(DD.isEmpty(a))throw DD.Error.handle("DD.Router.back","path",0,"string");b=b||0;var d=c.histories.indexOf(a);if(-1===d)c.start(a,!0);else{var e=d-c.currentState.index;history.go(e)}},historygo:function(a){function b(){history.go(-1),++a<0&&setTimeout(b,0)}b()},clearHistory:function(a){var b=this,c=[];b.histories.length;a=a||0,setTimeout(function(){var d=b.histories.pop();a&&a>0&&b.histories.length>a&&(c=b.histories.slice(0,a)),c.push(d),b.histories=c,b.history=c.length,b.currentState={path:b.histories[b.history-1],index:b.history,forward:!0}},20)}},window.addEventListener("popstate",function(a){var b=DD.Router,c=history.state;if(c){if(c.path!=b.histories[b.history-2])return history.go(-1),void(b.backward=!0);if(c){b.histories.pop(),b.history--;var d=b.currentState&&c.index<b.currentState.index?!1:!0;b.backward=!d,b.start(c.path,!1)&&(b.currentState=c,b.currentState.fw=d)}}});var c=function(a){var b=this;if(DD.isEmpty(a)||!DD.isObject(a))throw DD.Error.handle("invoke","route",0,"object");if(DD.isEmpty(a.module)&&!a.module instanceof DD.module)throw DD.Error.handle("invoke2","route","module",DD.words.module,"string");DD.assign(b,a),b.module=a.module,b.routes=[],b.type="string";var c;if(-1!==(c=b.path.indexOf("/:"))){b.type="param";var d=b.path.split("/:");b.path=d[0],b.paramNames=d.slice(1)}b.parent&&b.parent.routes.push(b),DD.Router.addRoute(b),a.routes&&a.routes.forEach(function(a){b.add(a)})};c.prototype.getFullPath=function(){for(var a=this,b="",c=a;c;c=c.parent){var d="";c.paramNames&&c.paramNames.forEach(function(a){c.data&&void 0!==c.data[a]&&(d+="/"+c.data[a])}),d=c.path+d,b=d+b}return b},c.prototype.getShowPath=function(){var a=this;return a.useParentPath&&a.parent?a.parent.getShowPath():a.getFullPath()},c.prototype.start=function(){function b(a){var b;c.module.model||new DD.Model({data:{},module:c.module}),window.$route={path:c.getFullPath(),data:c.data},c.module.model.data.$set("$route",window.$route),c.module.setForceRender(!0),DD.Router.defaultEnter&&DD.Router.defaultEnter.call(c,c.module.model),DD.isFunction(c.onEnter)&&c.onEnter(c.module.model),b=c.parent?c.parent.module.routerView:DD.App.routerView;var e,f;if(c["switch"]&&(c["switch"].style&&(e=c["switch"].style),c["switch"].time&&(f=c["switch"].time)),e||d["switch"]&&d["switch"].style&&(e=d["switch"].style),f||d["switch"]&&d["switch"].time&&(f=d["switch"].time),"slide"===e){var g,h,i,j=(b.children,DD.width(b,!0)),k=DD.css(b,"overflowX");if(0===b.children.length)i=b;else{g=DD.newEl("div"),DD.css(b,{overflowX:"hidden"}),DD.css(g,{boxSizing:"border-box",width:2*j+"px",padding:0,margin:0,transition:"transform "+f+"s ease-out",transform:"translate3d(0,0,0)",transformStyle:"preserve-3d",overflowX:"hidden"}),DD.merge(g,DD.extendElementConfig),g.$module=b.$module;var l=new DD.Event({view:g,eventName:"transitionend",handler:function(){l.unbind(),DD.css(b,"overflowX",k),g.children.length>1&&(DD.remove(g),DD.transChildren(i,b),c.module.view=b,d.switching=!1,setTimeout(function(){DD.css(g,"transition","transform "+f+"s ease-out")},50))}}),h=DD.newEl("div"),i=DD.newEl("div");DD.css(h,{width:j+"px","float":"left",overflowX:k}),DD.css(i,{width:j+"px","float":"left",overflowX:k}),d.switching=!0,DD.merge(i,DD.extendElementConfig),DD.transChildren(b,h),g.appendChild(h),b.appendChild(g);var m=DD.Router.currentState&&!DD.Router.currentState.forward?!1:!0;m?(g.appendChild(i),setTimeout(function(){DD.css(g,"transform","translate3d(-"+j+"px,0,0)")},50)):(DD.css(g,{transition:"",transform:"translate3d(-"+j+"px,0,0)"}),g.insertBefore(i,h),setTimeout(function(){DD.css(g,{transition:"transform "+f+"s ease-out",transform:"translate3d(0,0,0)"})},50))}c.module.view=i}else if("fade"===e){d.switching=!0;var j=DD.width(b,!0),h=DD.newEl("div"),i=DD.newEl("div"),n=f/2;if(0===b.children.length)c.module.view=b;else{DD.transChildren(b,h),b.appendChild(h),b.appendChild(i),DD.merge(i,DD.extendElementConfig),DD.merge(h,DD.extendElementConfig),i.$module=b.$module,h.$module=b.$module;var o=new DD.Event({view:h,eventName:"transitionend",handler:function(){try{b.removeChild(h)}catch(a){}DD.css(i,"opacity",1),o.unbind()}}),p=new DD.Event({view:i,eventName:"transitionend",handler:function(){DD.transChildren(i,b),c.module.view=b,b.removeChild(i),d.switching=!1,p.unbind()}});DD.css(h,"opacity",1),DD.css(i,"opacity",0);var q={transition:"opacity "+n+"s ease"};DD.css(h,q),DD.css(i,q),c.module.view=i,setTimeout(function(){DD.css(h,"opacity",0)},50)}}else{if(!b)throw DD.Error.handle("notexist",DD.words.routeView);c.module.view=b,DD.empty(c.module.view)}c.module.renderChildren=!0,DD.Renderer.add(c.module)}var c=this,d=DD.Router;if(d.current=c,c.loading=!0,DD.isString(c.module)){var e=c.module;if(c.module=DD.Module.get(e),void 0===c.module)throw DD.Error.handle("notexist1",DD.words.module,e)}var f;f=c.parent?c.parent.module.view:DD.App.view;var g=DD.get("[path='"+c.getFullPath()+"']",!1,f);g&&g.$routeConfig&&g.$routeConfig.active&&a(g),c.module.inited?b():c.module.init(function(){b()})},c.prototype.add=function(a){var b=this;a.parent=b;var d=a;return a instanceof DD.Route||(d=new c(a)),d},DD.Route=c,DD.createRoute=function(a){if(DD.isArray(a))a.forEach(function(a){new DD.Route(a)});else if(DD.isObject(a))return new DD.Route(a)},DD.Directive.create({name:"route",preOrder:10,init:function(b){var c=this;b&&(b=b.trim(),DD.isEmpty(b)||b&&"{{"===b.substr(0,2)&&"}}"===b.substr(b.length-2,2)||(DD.attr(c,"path",b),c.$routeConfig={path:b,active:DD.attr(c,"active")},c.removeAttribute("active"),new DD.Event({view:c,eventName:"click",handler:function(b,d,e){e.$routeConfig&&e.$routeConfig.active?a(e):DD.Router.start(c.$routeConfig.path)}})))},handler:function(){var b=this,c=b.$routeConfig.path,d=b.$routeConfig.active;if(!(DD.Router.links.length>0)){var e;if(d){var f=b.$getData().data;f&&f[d]===!0&&(e=!0)}if(e){if(a(b,c),DD.Router.current&&c===DD.Router.current.getFullPath())return;setTimeout(function(){0===c.indexOf(DD.Router.currentPath)?DD.Router.start(b.$routeConfig.path,!0,!0):DD.Router.start(b.$routeConfig.path),DD.Router.start(b.$routeConfig.path)},0)}}}}),DD.Directive.create({name:"router",preOrder:10,init:function(a){this.$isRouterView=!0},handler:function(){this.$module.routerView=this}})}(),function(){function a(a,b){for(var c,d=a.parentNode;d;d=d.parentNode)"FORM"===d.tagName&&(c=d);return c?[c.querySelector("[name='"+b+"']"),c]:null}function b(a){var b,c,d=this,e=a;-1!==(b=a.indexOf("|"))&&(e=a.substr(0,b),c=a.substr(b+1)),d.$validity={fn:e,tips:{},method:c};for(var f=d.children,g=0;g<f.length;g++){var h=f[g].getAttribute("rel");d.$validity.tips[h]=f[g]}d.$savedDoms.validity=d,DD.empty(d);var i=document.createTextNode("");DD.replaceNode(d,i)}function c(b){function c(a){for(var b=0;b<a.length;b++)switch(a[b]){case"valueMissing":return"required";case"typeMismatch":return"type";case"tooLong":return"maxLength";case"tooShort":return"minLength";case"rangeUnderflow":return"min";case"rangeOverflow":return"max";case"patternMismatch":return"pattern"}}var d=this;if(DD.isEmpty(b)&&(b=d.$getDirective("validity")),d.$validity&&d.$rendered){var e=a(d,d.$validity.fn);if(e){var f=e[0],g=e[1];DD.$validity.form!==g&&(DD.$validity.valid=!0,DD.$validity.form=g),d.nextSibling.$fromNode===d&&DD.remove(d.nextSibling);var h;if(null!==f){var i=[];if(d.$validity.method){var j=d.$module.methodFactory.get(d.$validity.method);if(DD.isFunction(j)){var k=j.call(d.$module,f.value);k||i.push("custum")}}var l=f.validity;if(!l.valid)for(var m in l)l[m]===!0&&i.push(m);if(i.length>0){DD.$validity.valid=!1;var h=c(i),n=d.$validity.tips,o=d.$savedDoms.validity.cloneNode(!1);if(o.$fromNode=d,DD.isEl(n[h]))o.appendChild(n[h]);else{var p=document.createTextNode(DD.compileStr(DD.FormMsgs[h],DD.attr(f,h)));o.appendChild(p)}DD.insertAfter(o,d)}}}}}DD.Directive.create({name:"validity",preOrder:5,init:b,handler:c}),DD.$validity={valid:!0,form:null,check:function(){return DD.$validity.valid}}}(),function(){function a(a,b,c){if(o.moving){DD.css(c,"transition","");var d=Date.now(),e=DD.height(c),f=DD.height(c.parentNode);if(d<o.t1){d-=o.t0;var g=(DD.getTranslate(c),o.v0*d-o.a*d*d/2|0),h=o.loc,j=h[0],k=h[1],l=h[2];switch(o.dir){case 0:k-=g,f-e>k&&(k=f-e);break;case 1:break;case 2:k+=g,k>0&&(k=0)}DD.css(c,"transform","translate3d("+j+"px,"+k+"px,"+l+"px)")}i(c)}}function b(a,b,c){f(c,0)}function c(a,b,c){f(c,2)}function d(a){}function e(a){}function f(a,b){if(n(a)){var c=Math.abs(event.v0),d=o.a,e=Math.abs(c/d),f=c*e-d*e*e/2|0;0===b&&(f=-f),o.dir=b,p.y.style.transition="opacity 5s linear",p.y.style.opacity="0.5",p.x.style.opacity="0.5",f=g(a,f),o.backFlag&&(e=Math.abs(2*f/c));var h="transform "+e/1e3+"s cubic-bezier(0.333333,0.666667,0.666667,1)";DD.css(a,"transition",h),DD.css(p.y,"transition",h),o.t0=Date.now(),o.t1=o.t0+e,o.moving=!0,o.v0=c;for(var i=DD.getTranslate(a),k=0;k<i.length;k++)o.loc[k]=i[k];var l=j(a,0,i[1]+f);i[0]=i[0]+"px",i[1]=i[1]+f+"px",i[2]=i[2]+"px",DD.css(a,"transform","translate3d("+i.join(",")+")"),p.y.style.transform="translate3d(0px,"+l[1]+"px,0px)"}}function g(a,b){var c=DD.getTranslate(a),d=DD.height(a.parentNode),e=DD.height(a),f=o.sideHeight;switch(o.dir){case 0:c[1]+b+e<d&&(o.backFlag=!0,0!=b&&b+c[1]+e<d+f&&(b=d-f-e-c[1])),o.overHeight=-(b+e+c[1]-d),d>e&&(o.overHeight=0);break;case 1:break;case 2:c[1]+b>0&&(o.backFlag=!0),c[1]+b>f&&0!=b&&(b=f-c[1]),o.overHeight=b-c[1],d>e&&(o.overHeight=0)}return b}function h(a){if(o.backFlag){var b=DD.getTranslate(a),c=b[0],d=b[1],e=a.parentNode.$events;DD.height(a);switch(o.dir){case 0:e.scrolltobottom instanceof DD.Event&&e.scrolltobottom.fire(),d=b[1]+o.overHeight;break;case 1:break;case 2:d=0,e.scrolltotop instanceof DD.Event&&e.scrolltotop.fire()}o.backFlag=!1,DD.css(a,"transition","transform 0.5s ease-out"),DD.css(a,"transform","translate3d("+c+"px,"+d+"px,0px)")}}function i(a){o={dir:0,v0:0,a:.001,loc:[0,0,0],t0:0,t1:0,moving:!1,backFlag:!1,sideHeight:100,overHeight:0},p.x.style.opacity="0",p.y.style.opacity="0"}function j(a,b,c){var d=0,e=0;if(0===o.dir||2===o.dir){var f=a.parentNode.offsetHeight,g=a.offsetHeight,h=f*f/g|0;DD.height(p.y,h),e=Math.abs(c)*f/g|0}return[d,e]}function k(a,b,c){q.draging=!0,q.loc=[a.touches[0].clientX,a.touches[0].clientY]}function l(a,b,c){if(q.draging){var d=c.parentNode.$events,e=DD.height(c.parentNode),f=DD.height(c),g=a.touches[0],h=g.clientX-q.loc[0],i=g.clientY-q.loc[1],j=DD.getTranslate(c),k=j[0],l=j[1],m=DD.getTranslate(c);switch(m[1]>0&&d.topdrag&&d.topdrag instanceof DD.Event&&d.topdrag.fire(),o.dir=i>0?2:0,o.dir){case 0:l+i+f>e-o.sideHeight&&(l+=i);break;case 1:k+=h;break;case 2:l+i<o.sideHeight&&(l+=i);break;default:k+=h}DD.css(c,{transition:"",transform:"translate3d("+j[0]+"px,"+l+"px,0px)"}),q.loc=[g.clientX,g.clientY],q.hasMove=!0}}function m(a,b,c){q.draging=!1;var d=c.parentNode.$events;if(n(c)){var e=DD.getTranslate(c);e[1]>0&&d.topfree&&d.topfree instanceof DD.Event&&(d.topfree.fire(),o.dir=2),q.hasMove&&(g(c,0),o.backFlag&&h(c)),q.hasMove=!1}}function n(a){var b=DD.height(a),c=DD.height(a.parentNode);return c>b&&0===o.dir||1===o.dir?!1:!0}var o={dir:0,v0:0,a:-.004,loc:[0,0,0],t0:0,t1:0,moving:!1,backFlag:!1,sideHeight:100,overHeight:0},p={},q={draging:!1,loc:[]};DD.Directive.create({name:"scroller",proOrder:1,init:function(f){var j=this,n=DD.newEl("div"),o=DD.newEl("div"),p=DD.newEl("div");DD.attr(o,"role","scrollbar"),DD.attr(p,"role","scrollbar"),DD.assign(j,{$scrollTo:function(a,b){var c=1e3,d=this.children[0],e={transition:""},f=.5,g=DD.getTranslate(d),h=0,i=0,j=DD.width(d),k=DD.height(d),l=DD.width(this),m=DD.height(this);if(DD.isString(b))switch(b){case"top":f=Math.abs(g[1])/c;break;case"bottom":h=m-k,f=h/c;break;case"left":break;case"right":break;default:var n=d.querySelector(b);if(!n)return;h=g[1]+Math.abs(g[1])-n.offsetTop,i=g[0]+Math.abs(g[0])-n.offsetLeft}a&&(f>2&&(f=2),e.transition="transform "+f+"s ease-out"),
k>m?m-k>h&&(h=m-k):h=0,j>l?l-j>i&&(i=l-j):i=0,e.transform="translate3d("+i+"px,"+h+"px,0)",DD.css(d,e)},$getLoc:function(){return DD.getTranslate(this.children[0])},$reLoc:function(){var a=this.children[0];setTimeout(function(){g(a,0),h(a)},50)}}),DD.transChildren(j,n),j.appendChild(n),j.appendChild(o),j.appendChild(p);var q,r;new DD.Event({view:n,eventName:"transitionend",handler:function(a,b,c){h(c),i(c)}}),new DD.Event({view:n,eventName:"touchstart",handler:function(b,c,d){a(b,c,d),k(b,c,d)}}),new DD.Event({view:n,eventName:"touchmove",handler:function(a,b,c){a.preventDefault(),l(a,b,c)}}),new DD.Event({view:n,eventName:"touchend",handler:function(a,b,c){m(a,b,c)}}),new DD.Event({view:n,eventName:"moveout",handler:function(a,b,c){m(a,b,c)}}),"horizontal"===f?(q={"overflow-x":"hidden"},r={"overflow-x":"auto","overflow-y":"inherit"},new DD.Event({view:n,eventName:"swipeleft",handler:d}),new DD.Event({view:n,eventName:"swiperight",handler:e})):"verticle"===f?(q={"overflow-y":"hidden"},r={"overflow-y":"visible","overflow-x":"inherit"},new DD.Event({view:n,eventName:"swipeup",handler:b}),new DD.Event({view:n,eventName:"swipedown",handler:c})):(q={overflow:"hidden"},r={overflow:"auto"}),DD.css(j,q),DD.css(n,r),DD.css(p,{width:"0.3rem",opacity:0,display:"block",borderRadius:"1px",background:"#333",zIndex:10,position:"absolute",right:"1px",transition:"opacity 5s linear",top:0})},handler:function(){var a=this;if(!p.y){var b=DD.get("[role='scrollbar']",!0,a);p.x=b[0],p.y=b[1]}}})}(),function(){DD.Directive.create({name:"plugin",proOrder:10,init:function(a){var b=this,c=DD.Plugin.plugins[a];if(!DD.isFunction(c))throw DD.Error.handle("notexist1",DD.words.plugin,a);b.$plugin=new c(b),b.$plugin.init(b)},handler:function(){var a=this,b=a.$getData();(a.$forceRender||a.$module.forceRender||b&&b.data&&b.data.$isChanged(!0))&&a.$plugin.render(a)}}),DD.Plugin={plugins:{},create:function(a,b){if(this.plugins[a])throw DD.Error.handle("exist1",DD.words.plugin,a);this.plugins[a]=b},remove:function(a){delete this.plugins[a]}}}(),DD.words={system:"系统",module:"模块",moduleClass:"模块类",model:"模型",directive:"指令",expression:"表达式",event:"事件",method:"方法",filter:"过滤器",data:"数据",dataItem:"数据项",route:"路由",routeView:"路由容器",plugin:"插件"},DD.ErrorMsgs={unknown:"未知错误",paramException:"{0} {1}方法参数错误，请参考api",invoke:"{0}方法调用参数{1}必须为{2}",invoke1:"{0}方法调用参数{1}必须为{2}或{3}",invoke2:"{0}方法调用参数{1}或{2}必须为{3}",invoke3:"{0}方法调用参数{1}不能为空",exist:"{0}已存在",exist1:"{0} {1}已存在",notexist:"{0}不存在",notexist1:"{0} {1}不存在",notupd:"{0}不可修改",notremove:"{0}不可删除",notremove1:"{0}{1}不可删除"},DD.FormMsgs={type:"请输入有效的{0}",unknown:"输入错误",required:"不能为空",min:"最小输入值为{0}",max:"最大输入值为{0}"},function(){function getColor(a,b){var c=[[179,33,38],[36,53,66],[80,142,150],[200,109,82],[129,188,158]];if(a.colors&&a.colors.length>b)return a.colors[b];var d,e,f;if(5>b){var g=c[b];d=g[0],e=g[1],f=g[2]}else{var h=b/5|0,i=b%5,g=c[i];d=g[0]+30*h,e=g[1]+30*h,f=g[2]+30*h,d>255&&(d%=255),e>255&&(e%=255),f>255&&(f=e%255)}return"rgb("+d+","+e+","+f+")"}function getConfig(el,obj){var arrs=["margins","colors","fixedCnt","category"],numbers=["margins","width","height","gridLine","fixedCnt"],obj1={};return DD.getOwnProps(obj).forEach(function(pn){var attr=DD.attr(el,pn.toLowerCase());if(attr){if(!attr)return;var pv=attr.trim(),isArr=!1;if(-1!==arrs.indexOf(pn)&&(pv=pv.split(","),isArr=!0),-1!==numbers.indexOf(pn))if(isArr)pv.forEach(function(v,i){try{pv[i]=eval(v)}catch(e){}});else try{pv=eval(pv)}catch(e){}("true"===pv||"false"===pv)&&(pv=eval(pv)),obj1[pn]=pv}}),obj1}function initDefs(a,b){var c=DD.newSvgEl("defs");a.appendChild(c);var d=DD.newSvgEl("marker");DD.attr(d,{id:"$chart_arrow",viewBox:"0 0 10 10",refX:1,refY:5,markerWidth:6,markerHeight:6,orient:"auto"});var e=DD.newSvgEl("path");if(DD.attr(e,{d:"M 0 0 L 10 5 L 0 10 z"}),d.appendChild(e),c.appendChild(d),b){var f=DD.newSvgEl("marker");DD.attr(f,{id:"$chart_circle",refX:3,refY:3,markerWidth:8,markerHeight:8,orient:"auto"});var g=DD.newSvgEl("circle");DD.attr(g,{cx:3,cy:3,r:1.5}),f.appendChild(g),c.appendChild(f);var h=DD.newSvgEl("marker");DD.attr(h,{id:"$chart_tri",viewBox:[0,0,20,20],refX:5,refY:6,markerWidth:9,markerHeight:9,orient:"auto"});var g=DD.newSvgEl("polygon");DD.attr(g,{points:"0,10 5,3 10,10"}),h.appendChild(g),c.appendChild(h);var i=DD.newSvgEl("marker");DD.attr(i,{id:"$chart_rect",refX:2,refY:2,markerWidth:5,markerHeight:5,orient:"auto"});var j=DD.newSvgEl("rect");DD.attr(j,{x:0,y:0,width:3,height:3}),i.appendChild(j),c.appendChild(i);var k=DD.newSvgEl("marker");DD.attr(k,{id:"$chart_cross",viewBox:[0,0,10,10],refX:3,refY:3,markerWidth:6,markerHeight:6,orient:"auto",stroke:"black"});var l=DD.newSvgEl("path");DD.attr(l,{d:"M0 0 L6 6 M0 6 L6 0 Z","stroke-width":2,fill:"none"}),k.appendChild(l),c.appendChild(k);var m=DD.newSvgEl("marker");DD.attr(m,{id:"$chart_star",viewBox:[0,0,35,35],refX:7,refY:7,markerWidth:15,markerHeight:15,orient:"auto",stroke:"black"});var l=DD.newSvgEl("path");DD.attr(l,{d:"m0.75,5.385069l4.20154,0l1.29846,-4.201666l1.29846,4.201666l4.20154,0l-3.399233,2.596676l1.298462,4.201661l-3.399229,-2.596801l-3.399227,2.596801l1.29846,-4.201661l-3.399233,-2.596676l0,0z","stroke-width":1}),m.appendChild(l),c.appendChild(m);var n=[];return n.push({id:"$chart_circle",m:f}),n.push({id:"$chart_tri",m:h}),n.push({id:"$chart_rect",m:i}),n.push({id:"$chart_star",m:m}),n.push({id:"$chart_cross",m:k}),n}}var LEGENDWORDLEN=12,WORDLEN=10,TITLEWORDLEN=18,TITLEHEIGHT=30,SPACELEN=30,DrawArea={left:0,top:0},DEFAULTS={type:"line",dataName:void 0,width:400,height:600,bgColor:"#fff",margins:[40,40,20,20],category:["number","number"],title:void 0,xTitle:void 0,yTitle:void 0,legend:void 0,titleColor:"#000",colors:void 0,fixedCnt:[0,0],marker:!1,showPercent:!1,showText:!1,gridLine:0,gridLineColor:"#ccc"},Chart=function(a){};Chart.prototype.init=function(a){var b=this;b.view=a,b.svg=DD.newSvgEl("svg"),a.appendChild(b.svg),DD.attr(b.svg,{width:"100%",height:"100%"}),DD.css(b.svg,{fontSize:12,background:b.bgColor})},Chart.prototype.render=function(a){var b=this,c=getConfig(a,DEFAULTS);if(!c.width||!c.height){var d=DD.width(a);if(!d)return void setTimeout(function(){b.render(a)},50);c.width=d,c.height=DD.height(a)}DD.extend(b,DEFAULTS,c),b.view=a,b.svg=b.view.children[0],DD.attr(b.svg,{width:b.width,height:b.height}),DD.empty(b.svg);var e=a.$getData();if(b.data=e.data,b.dataName&&(b.data=b.data[b.dataName]),b.data)switch(DrawArea={top:b.margins[0],left:b.margins[3],width:b.width-b.margins[1]-b.margins[3],height:b.height-b.margins[0]-b.margins[2]},b.type){case"line":b.drawLine();break;case"histogram":b.drawHistogram();break;case"pie":b.drawPie()}},Chart.prototype.initData=function(){for(var a,b,c,d,e=this,f=[],g=[],h=0;h<e.data.length;h++){var i=e.data[h];i.datas.sort(function(a,b){return a.x-b.x}),i.title||(i.title="数据"+h);for(var j=0;j<i.datas.length;j++){var k=i.datas[j];"number"===e.category[0]?((!a||k.x<a)&&(a=k.x),(!b||k.x>b)&&(b=k.x)):-1===f.indexOf(k.x)&&f.push(k.x),"number"===e.category[1]?((!c||k.y<c)&&(c=k.y),(!d||k.y>d)&&(d=k.y)):(k.y+="",-1===g.indexOf(k.y)&&g.push(k.y))}}f.length>0&&f.sort(),g.length>0&&g.sort(),e.dataArea={minx:a,maxx:b,miny:c,maxy:d,xValues:f,yValues:g}},Chart.prototype.drawTitle=function(){var a=this;if(a.title){var b=a.title,c=b.length*TITLEWORDLEN,d=(DrawArea.width-c)/2,e=a.margins[0],f=DD.newSvgEl("text");f.innerHTML=b,DD.attr(f,{transform:"translate("+d+","+e+")",fill:a.titleColor,"font-size":18,textLength:c}),a.svg.appendChild(f),DrawArea.top+=TITLEHEIGHT,DrawArea.height-=TITLEHEIGHT}},Chart.prototype.drawLegend=function(){var a=this;if("top"===a.legend||"bottom"===a.legend||"right"===a.legend){for(var b=0,c=0;c<a.data.length;c++)a.data[c].title.length>b&&(b=a.data[c].title.length);var d,e,f,g,h=50+b*WORDLEN,i=a.data.length,j=40,k=DrawArea.width;switch(a.legend){case"top":if(e=DrawArea.top,i*h>k){f=k,d=DrawArea.left;var l=Math.ceil(i*h/k);g=j*l}else f=i*h,g=j,d=(DrawArea.width-f)/2+DrawArea.left;DrawArea.top+=g,DrawArea.height-=g;break;case"right":f=h-25,g=j*i,e=DrawArea.top,d=DrawArea.left+DrawArea.width-f,DrawArea.width-=f;break;case"bottom":if(i*h>k){f=k,d=DrawArea.left;var l=Math.ceil(i*h/k);g=j*l}else f=i*h,g=j,d=(DrawArea.width-f)/2+DrawArea.left;e=DrawArea.top+DrawArea.height-g,DrawArea.height-=g}var m=DD.newSvgEl("g");DD.attr(m,{transform:"translate("+d+","+e+")"});for(var n=0,o=10,c=0;c<a.data.length;c++){var p=getColor(a,c),q=DD.newSvgEl("rect");DD.attr(q,{x:n,y:o,rx:5,ry:5,fill:p,width:30,height:15}),m.appendChild(q);var r=a.data[c].title,s=DD.newSvgEl("text");s.innerHTML=r,DD.attr(s,{x:n+35,y:o+12,fill:p}),DD.css(s,"fontSize",14),m.appendChild(s),f>=n+2*h?n+=h:(n=0,o+=j)}a.svg.appendChild(m)}},Chart.prototype.drawAxes=function(a){function b(){for(var b="",c=0,f=DrawArea.height,g=d.scaleValues.x.values,h=d.scaleValues.x.px,i=0===g[0]?g.length-1:g.length,j=0;i>=j;j++,c+=h){if(c%1&&(c=parseFloat(c.toFixed(d.fixedCnt))),b+=c+","+f+" ",j>0&&(b+=c+","+(f-5)+" "+c+","+f+" ",2===d.gridLine||3===d.gridLine)){var k=DD.newSvgEl("path");DD.attr(k,{d:"M"+c+" "+f+" V 0",stroke:d.gridLineColor,"stroke-width":1}),n.appendChild(k)}if(j>0){var l,m=DD.newSvgEl("text"),o=(g[j-1]+"").length*WORDLEN;l=1===a&&"string"===d.category[0]?(h-o)/2+(j-1)*h:c-o/2,DD.attr(m,{x:l,y:f+20}),DD.css(m,{fill:d.titleColor,strokeWidth:0});var p=0===g[0]?j:j-1;m.innerHTML=g[p],n.appendChild(m)}}if(b+=c-h+SPACELEN+","+f,d.xTitle){var q=DD.newSvgEl("text");q.innerHTML=d.xTitle,n.appendChild(q),DD.attr(q,{x:(DrawArea.width-12*d.xTitle.length)/2,y:f+50}),DD.css(q,{fill:d.titleColor,fontSize:14})}var r=DD.newSvgEl("polyline");DD.attr(r,{points:b,stroke:d.titleColor,"stroke-width":1,"marker-end":"url(#$chart_arrow)"}),n.appendChild(r),c=0,f=DrawArea.height,g=d.scaleValues.y.values,h=d.scaleValues.y.px,b="";for(var i=0===g[0]?g.length-1:g.length,j=0;i>=j;j++,f-=h){if(f%1&&(f=parseFloat(f.toFixed(d.fixedCnt[0]))),b+=c+","+f+" ",j>0&&(b+=c+5+","+f+" "+c+","+f+" ",1===d.gridLine||3===d.gridLine)){var k=DD.newSvgEl("path");DD.attr(k,{d:"M"+c+" "+f+" H "+DrawArea.width,stroke:d.gridLineColor,"stroke-width":1}),n.appendChild(k)}if(j>0){var m=DD.newSvgEl("text");DD.attr(m,{x:c-(g[j-1]+"").length*WORDLEN-10,y:f+4}),DD.css(m,{fill:d.titleColor,strokeWidth:0});var p=0===g[0]?j:j-1;m.innerHTML=g[p],n.appendChild(m)}}if(b+=c+","+(f+h-SPACELEN),d.yTitle){var q=DD.newSvgEl("text");q.innerHTML=d.yTitle;var s=12*d.yTitle.length,t=(DrawArea.height-s)/2-20;DD.attr(q,{transform:"rotate(90) translate("+t+","+(e+15)+")",textLength:s}),DD.css(q,{fill:d.titleColor,fontSize:14}),n.appendChild(q)}r=DD.newSvgEl("polyline"),DD.attr(r,{points:b,stroke:d.titleColor,"stroke-width":1,"marker-end":"url(#$chart_arrow)"}),n.appendChild(r)}function c(a,b){var c=7,d=1,e=1,f=b-a;if(f>100)for(;f>100;)f/=10,d*=10;10>f&&(f*=10,d/=10);var g=1;for(f>=20&&(f/=5,g=5);f>c;f/=2,e*=2);var h,i=g*e*d,j=[],k=Math.ceil((b-a)/i);0===a?(h=1,k--):0>a?(h=Math.floor(a/i),b%i&&(k+=1)):h=Math.floor(a/i);for(var l=h,k=k+h;k>=l;l++)j.push(i*l);return j}var d=this,e="number"===d.category[1]?(d.dataArea.maxy+"").length:d.dataArea.yValues[0].length;e=e*WORDLEN+20;var f=30,g=(d.yTitle?10:0)+e;DrawArea.top+=SPACELEN,DrawArea.height-=SPACELEN+(d.xTitle?25:0)+f,DrawArea.width-=g+SPACELEN+5,DrawArea.left+=g;var h=DrawArea.width,i=DrawArea.height,j="number"===d.category[0]?c(d.dataArea.minx,d.dataArea.maxx):d.dataArea.xValues,k="number"===d.category[1]?c(d.dataArea.miny,d.dataArea.maxy):d.dataArea.yValues,l=j.length,m=k.length;0===j[0]&&l--,0===k[0]&&m--,d.scaleValues={x:{values:j,px:h/l},y:{values:k,px:i/m}};var n=DD.newSvgEl("g");DD.attr(n,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),d.svg.appendChild(n),b()},Chart.prototype.drawLine=function(){function a(a,c){var d=b.markers[a%b.markers.length];if(a>=b.markers.length){var e=d.m.cloneNode(!0),f=d.id+"1";b.svg.querySelector("defs").appendChild(e),DD.attr(e,{id:f});var g={id:f,m:e};b.markers.push(g),d=g}return DD.attr(d.m,{fill:c,stroke:c}),d.id}var b=this;b.initData(),b.title&&b.drawTitle(),b.legend&&b.drawLegend(),b.markers=initDefs(b.svg,!0),b.drawAxes();var c=DD.newSvgEl("g");DD.attr(c,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),b.svg.appendChild(c);var d,e,f=(DrawArea.width,DrawArea.height),g=b.scaleValues.x.px,h=b.scaleValues.y.px,i=0,j=2,k=2,l=b.scaleValues.x.values[0],m=b.scaleValues.y.values[0];if("number"===b.category[0]){var n=b.scaleValues.x.values;i=n[n.length-1]-n[0],d=g*(n.length-1)/i,j=1}var o=0;if("number"===b.category[1]){var n=b.scaleValues.y.values;o=n[n.length-1]-n[0],e=h*(n.length-1)/o,k=1}var p=0;for(q=0;q<b.data.length;q++)b.data[q].datas.length>p&&(p=b.data[q].datas.length);for(var q=0;q<b.data.length;q++){var r=b.data[q].datas,s=DD.newSvgEl("path");c.appendChild(s);var t=getColor(b,q);DD.attr(s,{stroke:t,"stroke-width":2,fill:"none"});for(var u="",v=0;v<r.length;v++){var w=r[v];if(w){var x,y;if(1===j)x=(w.x-l)*d,0!==b.scaleValues.x.values[0]&&(x+=g);else{var z=b.scaleValues.x.values.indexOf(w.x);if(-1===z)continue;x=z*g+g}1===k?(y=f-(w.y-m)*e,0!==m&&(y-=h)):y=b.scaleValues.y.values.indexOf(w.y)*h-h,u+=0===v?"M"+x+" "+y:" L"+x+" "+y}}var A={d:u};if(b.marker){var B="url('#"+a(q,t)+"')";A={d:u,"marker-start":B,"marker-mid":B,"marker-end":B}}DD.attr(s,A)}},Chart.prototype.drawHistogram=function(){var a=this;initDefs(a.svg,!1),a.initData(),a.title&&a.drawTitle(),a.legend&&a.drawLegend(),a.drawAxes(1);var b=DD.newSvgEl("g");DD.attr(b,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),a.svg.appendChild(b);var c=(DrawArea.width,DrawArea.height),d=a.scaleValues.x.px,e=a.scaleValues.y.px,f=40,g=d,h=(g-10)/a.data.length,i=5;h>f&&(h=f,i=(g-h*a.data.length)/2+5);var j,k,l=0,m=0,n=a.scaleValues.x.values[0],o=a.scaleValues.y.values[0],p=a.scaleValues.x.values[a.scaleValues.x.values.length-1],q=a.scaleValues.y.values[a.scaleValues.y.values.length-1],r=0;if("number"===a.category[0]){var s=a.scaleValues.x.values;r=p-n,j=d*(s.length-1)/r,l=1}var t=0;if("number"===a.category[1]){var s=a.scaleValues.y.values;t=q-o,k=e*(s.length-1)/t,m=1}for(var u=0;u<a.data.length;u++)for(var v=getColor(a.svg,u),w=a.data[u].datas,x=0;x<w.length;x++){var y=w[x],z=x;if(y.x!==a.scaleValues.x.values[x]){z=-1;for(var A=0;A<a.scaleValues.x.values.length;A++)y.x===a.scaleValues.x.values[A]&&(z=A);if(-1===z)continue}if(y){var B,C;if(B=h*u+i+z*g,1===m)C=DrawArea.height-(y.y-o)*k,0!==o&&(C-=e);else{var D=a.scaleValues.y.values.indexOf(y.y);if(-1===D)continue;C=D*e-e}var c=DrawArea.height-C,E=DD.newSvgEl("rect");b.appendChild(E),DD.attr(E,{fill:v,x:B,y:C,width:h,height:c})}}},Chart.prototype.drawPie=function(){function a(a,b,c,d,e,f,g,h,i,j){var k=b+d*Math.cos(e),l=c-d*Math.sin(e),m=b+d*Math.cos(f),n=c-d*Math.sin(f),o="M "+k+" "+l+" A "+d+" "+d+" ,1,0,0, "+m+" "+n+" L "+b+" "+c+" Z",p=DD.newSvgEl("path");DD.attr(p,{d:o,fill:g}),a.appendChild(p);var q=e+(f-e)/2;if(i){var r=180*q/Math.PI,s=DD.newSvgEl("text");s.innerHTML=Math.abs(100*(f-e)/(2*Math.PI)).toFixed(2)+"%";var t=b+d-30-h.length*WORDLEN,u=c+5,v=b,w=c;r>90&&270>r&&(t=b-d+30,u=c+5,r-=180),DD.attr(s,{x:t,y:u,fill:"#fff",transform:"rotate("+-r+","+v+","+w+")"}),a.appendChild(s)}if(j&&h){var x=10,y=20;k=b+d*Math.cos(q),l=c-d*Math.sin(q),m=b+(d+y)*Math.cos(q),n=c-(d+y)*Math.sin(q);var z,A=m,B=h.length*WORDLEN;b>A?(A-=x,z=A-B-5):(A+=x,z=A+5);var p=DD.newSvgEl("path");DD.attr(p,{d:"M"+k+" "+l+" L "+m+" "+n+" H "+A,stroke:g,"stroke-width":1,fill:"none"}),a.appendChild(p);var C=DD.newSvgEl("text");C.innerHTML=h,DD.attr(C,{x:z,y:n+5,fill:g}),a.appendChild(C)}}var b=this;b.title&&b.drawTitle(),b.legend&&b.drawLegend();for(var c=0,d=0;d<b.data.length;d++)b.data[d].title.length>c&&(c=b.data[d].title.length);c*=WORDLEN;var e,f,g,h=DrawArea.width,i=DrawArea.height;if(b.showText){var j=50+2*c,k=60;h-j>=i-k?(e=(i-k)/2,DrawArea.left+=h/2-e,DrawArea.top+=k/2):(e=(h-j)/2,DrawArea.top+=i/2-e,DrawArea.left+=j/2)}else h>i?(e=i/2,DrawArea.left+=h/2-e):(e=h/2,DrawArea.top+=i/2-e);f=e,g=e,DrawArea.height=2*e,DrawArea.width=2*e;var l=DD.newSvgEl("g");DD.attr(l,{transform:"translate("+DrawArea.left+","+DrawArea.top+")"}),b.svg.appendChild(l);for(var m=0,d=0;d<b.data.length;d++){var n=b.data[d];m+=n.value}for(var o=0,p=0,d=0;d<b.data.length;d++){var n=b.data[d],q=n.value/m;o=p,p+=q*Math.PI*2,a(l,f,g,e,o,p,getColor(b.svg,d),n.title,b.showPercent,b.showText)}},DD.Plugin.create("chart",Chart)}(),function(){var a=function(){};a.prototype.init=function(a){var b=this,c="<div class='nd-plugin-msgbox-mb'></div><div class='nd-plugin-msgbox-box'><div class='nd-plugin-msgbox-title'>{{title}}</div><div class='nd-plugin-msgbox-content'>{{content}}</div><div class='nd-plugin-msgbox-btnct'><a class='nd-plugin-msgbox-btn' x-repeat='buttons'>{{text}}</a></div></div></div>";DD.addClass(a,"nd-plugin-msgbox");var d=DD.attr(a,"showItem")||"show";b.dataName=DD.attr(a,"dataName"),DD.attr(a,"x-show",d),a.$showItem=d,a.removeAttribute("showItem"),a.removeAttribute("dataName"),a.innerHTML=c,DD.Compiler.compile(a,a.$module)},a.prototype.render=function(a){function b(){for(var b=a.querySelectorAll(".nd-plugin-msgbox-btn"),e=100/c.buttons.length|0,f=c.callbacks,g=0;g<b.length;g++){DD.css(b[g],"width",e+"%"),DD.getOwnProps(b[g].$events).forEach(function(a){b[g].$events[a].unbind()}),b[g].$events={};var h;if(f&&f[g]){f[g];h=function(e,g,h){c[a.$showItem]=!1;for(var i=0,j=0;j<b.length;j++)if(b[j]===e.target){i=j;break}var k=d.methodFactory.get(f[i]);DD.isFunction(k)&&k.call(d.model,e,g,h)}}else h=function(b,d,e){c[a.$showItem]=!1};new DD.Event({eventName:"click",view:b[g],handler:h})}}var c=a.$getData().data;if(c){if(!c.buttons||!c.buttons.length)throw DD.Error.handle("invoke","msgbox","buttons","array");c.buttons&&c.buttons.length>=3&&c.buttons.splice(3,c.buttons.length);var d;d=c.module?c.module:a.$module,d&&setTimeout(b,0)}},DD.Plugin.create("msgbox",a)}();